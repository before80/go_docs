<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.111.3">
<link rel="canonical" type="text/html" href="http://ngd.cn/docs/stdLib/database/">
<link rel="alternate" type="application/rss&#43;xml" href="http://ngd.cn/docs/stdLib/database/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>database | go文档集</title>
<meta name="description" content="The most popular HTML, CSS, and JS library in the world.">
<meta property="og:title" content="database" />
<meta property="og:description" content="The most popular HTML, CSS, and JS library in the world." />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://ngd.cn/docs/stdLib/database/" />
<meta itemprop="name" content="database">
<meta itemprop="description" content="The most popular HTML, CSS, and JS library in the world."><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="database"/>
<meta name="twitter:description" content="The most popular HTML, CSS, and JS library in the world."/>




<link rel="preload" href="/scss/main.min.bb1f3a37154c4661ae02d3cb1a733edd8005db70f626370ca004c689a63ab7d4.css" as="style">
<link href="/scss/main.min.bb1f3a37154c4661ae02d3cb1a733edd8005db70f626370ca004c689a63ab7d4.css" rel="stylesheet" integrity="">

<link href="/css/extra.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-00000000-0');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">go文档集</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="/docs/"><span class="active">文档</span></a>
      </li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    <div class="td-search">
  <div class="td-search__icon"></div>
  <input type="search" class="td-search__input form-control td-search-input" placeholder="" aria-label="" autocomplete="off">
</div>

  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>

<a href="#" onclick="print();return false;"></a>.
</p><p>
<a href="/docs/stdLib/database/"></a>.
</p>
</div>



<h1 class="title">database</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-8666a57817ff6cec4f3a948d122a2561">sql</a></li>


    
  
    
    
	
<li>2: <a href="#pg-1c627c8ff1bab17a9f5e94758f67eea2">sql/driver</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-8666a57817ff6cec4f3a948d122a2561">1 - sql</h1>
    
	<h1 id="sql">sql</h1>
<p><a href="https://pkg.go.dev/database/sql@go1.20.1" target="_blank" rel="noopener">https://pkg.go.dev/database/sql@go1.20.1</a></p>
<p>​	sql包提供了一个围绕SQL(或类SQL)数据库的通用接口。</p>
<p>​	sql包必须与数据库驱动程序一起使用。参见<a href="https://golang.org/s/sqldrivers" target="_blank" rel="noopener">https://golang.org/s/sqldrivers</a>，获取驱动程序的列表。</p>
<p>​	不支持上下文取消的驱动程序将等到查询完成后才会返回。</p>
<p>​	关于用法的例子，请参见wiki页面<a href="https://golang.org/s/sqlwiki" target="_blank" rel="noopener">https://golang.org/s/sqlwiki</a>。</p>
<h3 id="example-opendbcli">Example (OpenDBCLI)</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">78
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;flag&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;os/signal&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">pool</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span> <span style="color:#7f848e">// 数据库连接池。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">flag</span>.<span style="color:#61afef;font-weight:bold">Int64</span>(<span style="color:#98c379">&#34;id&#34;</span>, <span style="color:#d19a66">0</span>, <span style="color:#98c379">&#34;person ID to find&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">dsn</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">flag</span>.<span style="color:#61afef;font-weight:bold">String</span>(<span style="color:#98c379">&#34;dsn&#34;</span>, <span style="color:#e06c75">os</span>.<span style="color:#61afef;font-weight:bold">Getenv</span>(<span style="color:#98c379">&#34;DSN&#34;</span>), <span style="color:#98c379">&#34;connection data source name&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">flag</span>.<span style="color:#61afef;font-weight:bold">Parse</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e5c07b">len</span>(<span style="color:#56b6c2">*</span><span style="color:#e06c75">dsn</span>) <span style="color:#56b6c2">==</span> <span style="color:#d19a66">0</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#98c379">&#34;missing dsn flag&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">id</span> <span style="color:#56b6c2">==</span> <span style="color:#d19a66">0</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#98c379">&#34;missing person ID&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">err</span> <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#7f848e">// 打开一个驱动程序通常不会尝试连接到数据库。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">pool</span>, <span style="color:#e06c75">err</span> = <span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Open</span>(<span style="color:#98c379">&#34;driver-name&#34;</span>, <span style="color:#56b6c2">*</span><span style="color:#e06c75">dsn</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>       <span style="color:#7f848e">// 这将不是一个连接错误，而是一个DSN解析错误或其他初始化错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#98c379">&#34;unable to use data source name&#34;</span>, <span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">pool</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">pool</span>.<span style="color:#61afef;font-weight:bold">SetConnMaxLifetime</span>(<span style="color:#d19a66">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">pool</span>.<span style="color:#61afef;font-weight:bold">SetMaxIdleConns</span>(<span style="color:#d19a66">3</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">pool</span>.<span style="color:#61afef;font-weight:bold">SetMaxOpenConns</span>(<span style="color:#d19a66">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">stop</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithCancel</span>(<span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">Background</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">stop</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">appSignal</span> <span style="color:#56b6c2">:=</span> <span style="color:#e5c07b">make</span>(<span style="color:#c678dd">chan</span> <span style="color:#e06c75">os</span>.<span style="color:#e06c75">Signal</span>, <span style="color:#d19a66">3</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">signal</span>.<span style="color:#61afef;font-weight:bold">Notify</span>(<span style="color:#e06c75">appSignal</span>, <span style="color:#e06c75">os</span>.<span style="color:#e06c75">Interrupt</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">go</span> <span style="color:#c678dd">func</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#56b6c2">&lt;-</span><span style="color:#e06c75">appSignal</span>
</span></span><span style="display:flex;"><span>		<span style="color:#61afef;font-weight:bold">stop</span>()
</span></span><span style="display:flex;"><span>	}()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Ping</span>(<span style="color:#e06c75">ctx</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#56b6c2">*</span><span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">// Ping数据库，以验证用户提供的DSN是否有效，服务器是否可以访问。如果Ping失败，则以错误退出程序。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Ping</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#d19a66">1</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">pool</span>.<span style="color:#61afef;font-weight:bold">PingContext</span>(<span style="color:#e06c75">ctx</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;unable to connect to database: %v&#34;</span>, <span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">// 在数据库中查询所要求的信息并打印出结果。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e">// 如果查询失败，则以错误退出程序。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">id</span> <span style="color:#e5c07b">int64</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#d19a66">5</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">pool</span>.<span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;select p.name from people as p where p.id = :id;&#34;</span>, <span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#98c379">&#34;id&#34;</span>, <span style="color:#e06c75">id</span>)).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#98c379">&#34;unable to execute search query&#34;</span>, <span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#98c379">&#34;name=&#34;</span>, <span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="example-opendbservice">Example (OpenDBService)</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">149
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;encoding/json&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;io&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 打开驱动程序通常不会尝试连接数据库。这将不是连接错误，而是DSN解析错误或其他初始化错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">db</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Open</span>(<span style="color:#98c379">&#34;driver-name&#34;</span>, <span style="color:#98c379">&#34;database=test1&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 打开驱动程序通常不会尝试连接数据库。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>        这不会是连接错误，而是<span style="color:#e06c75">DSN</span>解析错误或其他初始化错误。
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">SetConnMaxLifetime</span>(<span style="color:#d19a66">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">SetMaxIdleConns</span>(<span style="color:#d19a66">50</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">SetMaxOpenConns</span>(<span style="color:#d19a66">50</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">s</span> <span style="color:#56b6c2">:=</span> <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">Service</span>{<span style="color:#e06c75">db</span>: <span style="color:#e06c75">db</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">ListenAndServe</span>(<span style="color:#98c379">&#34;:8080&#34;</span>, <span style="color:#e06c75">s</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Service</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Service</span>) <span style="color:#61afef;font-weight:bold">ServeHTTP</span>(<span style="color:#e06c75">w</span> <span style="color:#e06c75">http</span>.<span style="color:#e06c75">ResponseWriter</span>, <span style="color:#e06c75">r</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">http</span>.<span style="color:#e06c75">Request</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">s</span>.<span style="color:#e06c75">db</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">switch</span> <span style="color:#e06c75">r</span>.<span style="color:#e06c75">URL</span>.<span style="color:#e06c75">Path</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">default</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#98c379">&#34;not found&#34;</span>, <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusNotFound</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#98c379">&#34;/healthz&#34;</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">r</span>.<span style="color:#61afef;font-weight:bold">Context</span>(), <span style="color:#d19a66">1</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">s</span>.<span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">PingContext</span>(<span style="color:#e06c75">ctx</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Sprintf</span>(<span style="color:#98c379">&#34;db down: %v&#34;</span>, <span style="color:#e06c75">err</span>), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusFailedDependency</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">w</span>.<span style="color:#61afef;font-weight:bold">WriteHeader</span>(<span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusOK</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#98c379">&#34;/quick-action&#34;</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 这是一个短查询语句。使用请求上下文作为上下文超时的基础。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">r</span>.<span style="color:#61afef;font-weight:bold">Context</span>(), <span style="color:#d19a66">3</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">5</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">org</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">10</span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> <span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">`
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">select
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	p.name
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">from
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	people as p
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	join organization as o on p.organization = o.id
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">where
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	p.id = :id
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	and o.id = :org
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">;`</span>,
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#98c379">&#34;id&#34;</span>, <span style="color:#e06c75">id</span>),
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#98c379">&#34;org&#34;</span>, <span style="color:#e06c75">org</span>),
</span></span><span style="display:flex;"><span>		).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">ErrNoRows</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#98c379">&#34;not found&#34;</span>, <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusNotFound</span>)
</span></span><span style="display:flex;"><span>				<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">err</span>.<span style="color:#61afef;font-weight:bold">Error</span>(), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">io</span>.<span style="color:#61afef;font-weight:bold">WriteString</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#98c379">&#34;/long-action&#34;</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 这是一个长查询语句。使用请求上下文作为上下文超时的基础，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>        <span style="color:#7f848e">// 但给它一些时间来完成。如果客户端在查询完成之前取消了操作，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>        <span style="color:#7f848e">// 则该查询也将被取消。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">r</span>.<span style="color:#61afef;font-weight:bold">Context</span>(), <span style="color:#d19a66">60</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> <span style="color:#e06c75">names</span> []<span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">rows</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;select p.name from people as p where p.active = true;&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">err</span>.<span style="color:#61afef;font-weight:bold">Error</span>(), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">for</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Next</span>() {
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">var</span> <span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">err</span> = <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>				<span style="color:#c678dd">break</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">names</span> = <span style="color:#e5c07b">append</span>(<span style="color:#e06c75">names</span>, <span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 检查行&#34;Close&#34;时是否有错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>        <span style="color:#7f848e">// 如果在单个批处理中执行了多个语句并且写入了行，那么这可能更重要。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">closeErr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Close</span>(); <span style="color:#e06c75">closeErr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">closeErr</span>.<span style="color:#61afef;font-weight:bold">Error</span>(), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 检查行扫描错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">err</span>.<span style="color:#61afef;font-weight:bold">Error</span>(), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 检查行迭代过程中是否有错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> = <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Err</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">err</span>.<span style="color:#61afef;font-weight:bold">Error</span>(), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">json</span>.<span style="color:#61afef;font-weight:bold">NewEncoder</span>(<span style="color:#e06c75">w</span>).<span style="color:#61afef;font-weight:bold">Encode</span>(<span style="color:#e06c75">names</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#98c379">&#34;/async-action&#34;</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// 这个操作有副作用，我们希望即使客户端在HTTP请求过程中部分取消了，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>        <span style="color:#7f848e">// 它也能够保留。为此，我们不使用http请求上下文作为超时的基础。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">Background</span>(), <span style="color:#d19a66">10</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> <span style="color:#e06c75">orderRef</span> = <span style="color:#98c379">&#34;ABC123&#34;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">TxOptions</span>{<span style="color:#e06c75">Isolation</span>: <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">LevelSerializable</span>})
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">_</span>, <span style="color:#e06c75">err</span> = <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;stored_proc_name&#34;</span>, <span style="color:#e06c75">orderRef</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Rollback</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#e06c75">err</span>.<span style="color:#61afef;font-weight:bold">Error</span>(), <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">err</span> = <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Commit</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Error</span>(<span style="color:#e06c75">w</span>, <span style="color:#98c379">&#34;action in unknown state, check state before attempting again&#34;</span>, <span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">w</span>.<span style="color:#61afef;font-weight:bold">WriteHeader</span>(<span style="color:#e06c75">http</span>.<span style="color:#e06c75">StatusOK</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="常量">常量</h2>
<p>This section is empty.</p>
<h2 id="变量">变量</h2>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1898" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ErrConnDone</span> = <span style="color:#e06c75">errors</span>.<span style="color:#61afef;font-weight:bold">New</span>(<span style="color:#98c379">&#34;sql: connection is already closed&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ErrConnDone 被任何在已经返回到连接池的连接上执行的操作返回。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=441" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ErrNoRows</span> = <span style="color:#e06c75">errors</span>.<span style="color:#61afef;font-weight:bold">New</span>(<span style="color:#98c379">&#34;sql: no rows in result set&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ErrNoRows 在 Scan 时由 QueryRow 不返回行时返回。在这种情况下，QueryRow 返回一个占位符 *Row 值，直到扫描时才会出现此错误。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2185" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ErrTxDone</span> = <span style="color:#e06c75">errors</span>.<span style="color:#61afef;font-weight:bold">New</span>(<span style="color:#98c379">&#34;sql: transaction has already been committed or rolled back&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ErrTxDone 被任何在已经提交或回滚的事务上执行的操作返回。</p>
<h2 id="函数">函数</h2>
<h4 id="func-drivershttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol64----go14">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=64" target="_blank" rel="noopener">Drivers</a>  &lt;- go1.4</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Drivers</span>() []<span style="color:#e5c07b">string</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Drivers函数返回已注册驱动程序名称的排序列表。</p>
<h4 id="func-registerhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol44">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=44" target="_blank" rel="noopener">Register</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Register</span>(<span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">driver</span> <span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Driver</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Register函数使用提供的名称使数据库驱动程序可用。如果使用相同的名称两次调用Register或者驱动程序为nil，则会引发panic。</p>
<h2 id="类型">类型</h2>
<h3 id="type-columntypehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3083----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3083" target="_blank" rel="noopener">ColumnType</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">ColumnType</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ColumnType结构体包含列的名称和类型。</p>
<h4 id="columntype-databasetypenamehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3137----go18">(*ColumnType) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3137" target="_blank" rel="noopener">DatabaseTypeName</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ci</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>) <span style="color:#61afef;font-weight:bold">DatabaseTypeName</span>() <span style="color:#e5c07b">string</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	DatabaseTypeName方法返回列类型的数据库系统名称。如果返回空字符串，则不支持驱动程序类型名称。请查阅您的驱动程序文档以获取驱动程序数据类型列表。不包括长度说明符。常见类型名称包括&quot;VARCHAR&quot;，&ldquo;TEXT&rdquo;，&ldquo;NVARCHAR&rdquo;，&ldquo;DECIMAL&rdquo;，&ldquo;BOOL&rdquo;，&ldquo;INT&quot;和&quot;BIGINT&rdquo;。</p>
<h4 id="columntype-decimalsizehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3114----go18">(*ColumnType) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3114" target="_blank" rel="noopener">DecimalSize</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ci</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>) <span style="color:#61afef;font-weight:bold">DecimalSize</span>() (<span style="color:#e06c75">precision</span>, <span style="color:#e06c75">scale</span> <span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	DecimalSize方法返回十进制类型的比例和精度。如果不适用或不受支持，则为假。</p>
<h4 id="columntype-lengthhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3108----go18">(*ColumnType) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3108" target="_blank" rel="noopener">Length</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ci</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>) <span style="color:#61afef;font-weight:bold">Length</span>() (<span style="color:#e06c75">length</span> <span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Length方法返回变量长度列类型(如文本和二进制字段类型)的列类型长度。如果类型长度不受限制，则值将是math.MaxInt64(任何数据库限制仍将适用)。如果列类型不是可变长度，例如int，或者驱动程序不支持，则为false。</p>
<h4 id="columntype-namehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3099----go18">(*ColumnType) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3099" target="_blank" rel="noopener">Name</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ci</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>) <span style="color:#61afef;font-weight:bold">Name</span>() <span style="color:#e5c07b">string</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Name方法返回列的名称或别名。</p>
<h4 id="columntype-nullablehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3127----go18">(*ColumnType) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3127" target="_blank" rel="noopener">Nullable</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ci</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>) <span style="color:#61afef;font-weight:bold">Nullable</span>() (<span style="color:#e06c75">nullable</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Nullable方法报告列是否可以为null。如果驱动程序不支持此属性，则ok将为false。</p>
<h4 id="columntype-scantypehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3121----go18">(*ColumnType) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3121" target="_blank" rel="noopener">ScanType</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ci</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>) <span style="color:#61afef;font-weight:bold">ScanType</span>() <span style="color:#e06c75">reflect</span>.<span style="color:#e06c75">Type</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ScanType方法返回适合使用Rows.Scan进行扫描的Go类型。如果驱动程序不支持此属性，则ScanType将返回空接口的类型。</p>
<h3 id="type-connhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1938----go19">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1938" target="_blank" rel="noopener">Conn</a>  &lt;- go1.9</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Conn</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Conn结构体表示一个单独的数据库连接，而不是数据库连接池。除非有特定需要一个连续的单个数据库连接，否则请优先使用 DB 来运行查询。</p>
<p>​	在调用 Close方法以将连接返回到数据库池之前，Conn 必须调用 Close方法，可能与正在运行的查询同时进行。</p>
<p>​	调用 Close方法后，连接上的所有操作都将失败，并返回 ErrConnDone。</p>
<h4 id="conn-begintxhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2065----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2065" target="_blank" rel="noopener">BeginTx</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">opts</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">TxOptions</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	BeginTx方法开始一个事务。</p>
<p>​	提供的上下文会一直使用到事务提交或回滚。如果上下文被取消，sql 包将回滚事务。如果传递给 BeginTx 的上下文被取消，Tx.Commit 将返回一个错误。</p>
<p>​	提供的 TxOptions 是可选的，如果应使用默认值，则可以为 nil。如果使用了非默认的隔离级别，并且该驱动程序不支持，将返回一个错误。</p>
<h4 id="conn-closehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2107----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2107" target="_blank" rel="noopener">Close</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Close方法将连接返回到连接池。Close方法后的所有操作都将返回 ErrConnDone。Close 方法可以与其他操作并发调用，它将阻塞，直到所有其他操作完成。在调用 Close 前，先取消任何使用的上下文，然后直接调用它可能会很有用。</p>
<h4 id="conn-execcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1977----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1977" target="_blank" rel="noopener">ExecContext</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ExecContext方法执行一条查询，而不返回任何行。args 用于查询中的任何占位符参数。</p>
<h5 id="execcontext-example">ExecContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// A *DB is a pool of connections. Call Conn to reserve a connection for
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// exclusive use.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">conn</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Conn</span>(<span style="color:#e06c75">ctx</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">conn</span>.<span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#7f848e">// Return the connection to the pool.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">41</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">result</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">conn</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">`UPDATE balances SET balance = balance + 10 WHERE user_id = ?;`</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">rows</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">result</span>.<span style="color:#61afef;font-weight:bold">RowsAffected</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">rows</span> <span style="color:#56b6c2">!=</span> <span style="color:#d19a66">1</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;expected single row affected, got %d rows affected&#34;</span>, <span style="color:#e06c75">rows</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="conn-pingcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1967----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1967" target="_blank" rel="noopener">PingContext</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">PingContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	PingContext方法验证与数据库的连接是否仍然存活。</p>
<h4 id="conn-preparecontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2014----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2014" target="_blank" rel="noopener">PrepareContext</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">PrepareContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	PrepareContext方法为以后的查询或执行创建一个准备好的语句。可以从返回的语句中并发运行多个查询或执行。调用者在不再需要语句时必须调用语句的 Close 方法。</p>
<p>​	提供的上下文用于准备语句，而不是执行语句的上下文。</p>
<h4 id="conn-querycontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1987----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1987" target="_blank" rel="noopener">QueryContext</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryContext方法执行一个返回行的查询，通常是SELECT。args参数用于查询中的任何占位符参数。</p>
<h4 id="conn-queryrowcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2001----go19">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2001" target="_blank" rel="noopener">QueryRowContext</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRowContext方法执行一个预期返回最多一行的查询。QueryRowContext总是返回一个非nil值。错误会被推迟到调用Row的Scan方法时返回。如果查询没有选择任何行，则<code>* Row</code>的Scan将返回ErrNoRows。否则，<code>*Row</code>的Scan扫描第一个选择的行并丢弃其余的行。</p>
<h4 id="conn-rawhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2027----go113">(*Conn) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2027" target="_blank" rel="noopener">Raw</a>  &lt;- go1.13</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>) <span style="color:#61afef;font-weight:bold">Raw</span>(<span style="color:#e06c75">f</span> <span style="color:#c678dd">func</span>(<span style="color:#e06c75">driverConn</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>) (<span style="color:#e06c75">err</span> <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Raw方法执行f，暴露底层驱动程序连接。driverConn不能在f之外使用。</p>
<p>​	一旦f返回且err不是driver.ErrBadConn，Conn将继续可用，直到调用Conn.Close为止。</p>
<h3 id="type-dbhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol455">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=455" target="_blank" rel="noopener">DB</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">DB</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	DB结构体是表示零个或多个底层连接池的数据库句柄。它可以被多个goroutine并发使用。</p>
<p>​	sql包会自动创建和释放连接；它还维护一个空闲连接的自由池。如果数据库有每个连接状态的概念，则可以在事务(Tx)或连接(Conn)中可靠地观察到此状态。一旦调用DB.Begin，返回的Tx将绑定到单个连接。一旦在事务上调用Commit或Rollback，该事务的连接就会返回到DB的空闲连接池中。池的大小可以使用SetMaxIdleConns进行控制。</p>
<h4 id="func-openhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol813">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=813" target="_blank" rel="noopener">Open</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Open</span>(<span style="color:#e06c75">driverName</span>, <span style="color:#e06c75">dataSourceName</span> <span style="color:#e5c07b">string</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Open函数通过其数据库驱动程序名称和驱动程序特定的数据源名称打开一个数据库，通常至少包含数据库名称和连接信息。</p>
<p>​	大多数用户将通过返回<code>*DB</code>的特定于驱动程序的连接助手函数打开数据库。Go标准库中不包含任何数据库驱动程序。请参阅https://golang.org/s/sqldrivers以获取第三方驱动程序的列表。</p>
<p>​	Open函数可能只验证其参数而不创建到数据库的连接。要验证数据源名称是否有效，请调用Ping。</p>
<p>​	返回的DB可安全地由多个goroutine并发使用，并维护其自己的空闲连接池。因此，应该只调用一次Open函数。很少需要关闭DB。</p>
<h4 id="func-opendbhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol781----go110">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=781" target="_blank" rel="noopener">OpenDB</a>  &lt;- go1.10</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">OpenDB</span>(<span style="color:#e06c75">c</span> <span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Connector</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	OpenDB函数使用Connector打开数据库，允许驱动程序绕过基于字符串的数据源名称。</p>
<p>​	大多数用户将通过特定于驱动程序的连接助手函数打开数据库，该函数返回*DB。Go标准库中不包含任何数据库驱动程序。有关第三方驱动程序的列表，请参见https://golang.org/s/sqldrivers。</p>
<p>​	OpenDB函数可能只是验证其参数而没有创建到数据库的连接。要验证数据源名称是否有效，请调用Ping。</p>
<p>​	返回的DB安全地支持多个goroutine的并发使用，并维护其自己的空闲连接池。因此，OpenDB函数应该只调用一次。很少需要关闭DB。</p>
<h4 id="db-beginhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1848">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1848" target="_blank" rel="noopener">Begin</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Begin</span>() (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Begin方法开始一个事务。默认的隔离级别取决于驱动程序。</p>
<p>​	Begin方法在内部使用context.Background；要指定上下文，请使用BeginTx方法。</p>
<h4 id="db-begintxhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1831----go18">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1831" target="_blank" rel="noopener">BeginTx</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">opts</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">TxOptions</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	BeginTx方法开始一个事务。</p>
<p>​	提供的上下文用于直到事务提交或回滚。如果上下文被取消，则sql包将回滚事务。如果提供给BeginTx方法的上下文被取消，Tx.Commit将返回错误。</p>
<p>​	提供的TxOptions是可选的，如果应使用默认值，则可以为nil。如果使用驱动程序不支持的非默认隔离级别，则会返回错误。</p>
<h5 id="begintx-example">BeginTx Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">TxOptions</span>{<span style="color:#e06c75">Isolation</span>: <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">LevelSerializable</span>})
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">37</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">_</span>, <span style="color:#e06c75">execErr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#98c379">`UPDATE users SET status = ? WHERE id = ?`</span>, <span style="color:#98c379">&#34;paid&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">execErr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">_</span> = <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Rollback</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">execErr</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Commit</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-closehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol876">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=876" target="_blank" rel="noopener">Close</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Close方法关闭数据库并防止启动新查询。然后，Close方法等待在服务器上已经开始处理的所有查询完成。</p>
<p>​	很少需要关闭DB，因为DB句柄应该是长期存在的并在许多goroutine之间共享。</p>
<h4 id="db-connhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1907----go19">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1907" target="_blank" rel="noopener">Conn</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Conn</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Conn</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Conn方法通过打开一个新连接或从连接池中返回一个现有连接来返回单个连接。 Conn 将阻塞直到返回连接或取消 ctx。在同一 Conn 上运行的查询将在同一个数据库会话中运行。</p>
<p>​	每个 Conn方法必须通过调用 Conn.Close 返回到数据库池中。</p>
<h4 id="db-driverhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1892">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1892" target="_blank" rel="noopener">Driver</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Driver</span>() <span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Driver</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Driver方法返回数据库的底层驱动程序。</p>
<h4 id="db-exechttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1646">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1646" target="_blank" rel="noopener">Exec</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Exec方法执行一个查询，而不返回任何行。 args 是查询中任何占位符参数的参数。</p>
<p>​	Exec方法内部使用 context.Background。要指定上下文，请使用 ExecContext方法。</p>
<h4 id="db-execcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1629----go18">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1629" target="_blank" rel="noopener">ExecContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ExecContext方法执行一个查询，而不返回任何行。 args 是查询中任何占位符参数的参数。</p>
<h5 id="execcontext-example-1">ExecContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">47</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">result</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;UPDATE balances SET balance = balance + 10 WHERE user_id = ?&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">rows</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">result</span>.<span style="color:#61afef;font-weight:bold">RowsAffected</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">rows</span> <span style="color:#56b6c2">!=</span> <span style="color:#d19a66">1</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;expected to affect 1 row, affected %d&#34;</span>, <span style="color:#e06c75">rows</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-pinghttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol866----go11">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=866" target="_blank" rel="noopener">Ping</a>  &lt;- go1.1</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Ping</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Ping方法验证与数据库的连接仍然存在，必要时建立连接。</p>
<p>​	Ping方法内部使用 context.Background。要指定上下文，请使用 PingContext方法。</p>
<h4 id="db-pingcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol845----go18">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=845" target="_blank" rel="noopener">PingContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">PingContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	PingContext方法验证与数据库的连接仍然存在，必要时建立连接。</p>
<h5 id="pingcontext-example">PingContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Ping和PingContext可用于确定是否仍然可以与数据库服务器通信。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 在命令行应用程序中使用Ping可以建立进一步查询是可能的；DSN是有效的。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 在长时间运行的服务中，Ping可以是健康检查系统的一部分。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">cancel</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">context</span>.<span style="color:#61afef;font-weight:bold">WithTimeout</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#d19a66">1</span><span style="color:#56b6c2">*</span><span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#61afef;font-weight:bold">cancel</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">status</span> <span style="color:#56b6c2">:=</span> <span style="color:#98c379">&#34;up&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">PingContext</span>(<span style="color:#e06c75">ctx</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">status</span> = <span style="color:#98c379">&#34;down&#34;</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#e06c75">status</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-preparehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1576">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1576" target="_blank" rel="noopener">Prepare</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Prepare方法创建一个准备好的语句，以便以后进行查询或执行操作。可以从返回的语句中并发运行多个查询或执行。调用者在语句不再需要时必须调用语句的 Close 方法。</p>
<p>​	Prepare方法内部使用 context.Background。要指定上下文，请使用 PrepareContext方法。</p>
<h5 id="prepare-example">Prepare Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">projects</span> <span style="color:#56b6c2">:=</span> []<span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">mascot</span>  <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">release</span> <span style="color:#e5c07b">int</span>
</span></span><span style="display:flex;"><span>	}{
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;tux&#34;</span>, <span style="color:#d19a66">1991</span>},
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;duke&#34;</span>, <span style="color:#d19a66">1996</span>},
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;gopher&#34;</span>, <span style="color:#d19a66">2009</span>},
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;moby dock&#34;</span>, <span style="color:#d19a66">2013</span>},
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">stmt</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#98c379">&#34;INSERT INTO projects(id, mascot, release, category) VALUES( ?, ?, ?, ? )&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#7f848e">// Prepared statements take up server resources and should be closed after use.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">id</span>, <span style="color:#e06c75">project</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">range</span> <span style="color:#e06c75">projects</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">_</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#e06c75">id</span><span style="color:#56b6c2">+</span><span style="color:#d19a66">1</span>, <span style="color:#e06c75">project</span>.<span style="color:#e06c75">mascot</span>, <span style="color:#e06c75">project</span>.<span style="color:#e06c75">release</span>, <span style="color:#98c379">&#34;open source&#34;</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-preparecontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1556----go18">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1556" target="_blank" rel="noopener">PrepareContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">PrepareContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	PrepareContext方法创建一个准备好的语句，以便以后进行查询或执行操作。可以从返回的语句中并发运行多个查询或执行。调用者在语句不再需要时必须调用语句的 Close 方法。</p>
<p>​	提供的上下文用于语句的准备，而不是语句的执行。</p>
<h4 id="db-queryhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1716">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1716" target="_blank" rel="noopener">Query</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Query方法执行返回行的查询，通常是 SELECT。args 是查询中的任何占位符参数。</p>
<p>​	Query方法内部使用 context.Background。要指定上下文，请使用 QueryContext方法。</p>
<h5 id="query-example">Query Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">71
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">age</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">27</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">q</span> <span style="color:#56b6c2">:=</span> <span style="color:#98c379">`
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">create temp table uid (id bigint); -- Create temp table for queries.
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">insert into uid
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">select id from users where age &lt; ?; -- Populate temp table.
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">-- First result set.
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">select
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	users.id, name
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">from
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	users
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	join uid on users.id = uid.id
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">;
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">-- Second result set.
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">select 
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	ur.user, ur.role
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">from
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	user_roles as ur
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	join uid on uid.id = ur.user
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">;
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">	`</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">rows</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">q</span>, <span style="color:#e06c75">age</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Next</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">id</span>   <span style="color:#e5c07b">int64</span>
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">id</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;id %d name is %s\n&#34;</span>, <span style="color:#e06c75">id</span>, <span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> !<span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">NextResultSet</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;expected more result sets: %v&#34;</span>, <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Err</span>())
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">roleMap</span> = <span style="color:#c678dd">map</span>[<span style="color:#e5c07b">int64</span>]<span style="color:#e5c07b">string</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#d19a66">1</span>: <span style="color:#98c379">&#34;user&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#d19a66">2</span>: <span style="color:#98c379">&#34;admin&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#d19a66">3</span>: <span style="color:#98c379">&#34;gopher&#34;</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Next</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">id</span>   <span style="color:#e5c07b">int64</span>
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">role</span> <span style="color:#e5c07b">int64</span>
</span></span><span style="display:flex;"><span>		)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">id</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">role</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;id %d has role %s\n&#34;</span>, <span style="color:#e06c75">id</span>, <span style="color:#e06c75">roleMap</span>[<span style="color:#e06c75">role</span>])
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Err</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-querycontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1699----go18">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1699" target="_blank" rel="noopener">QueryContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryContext方法执行返回行的查询，通常是 SELECT。args 是查询中的任何占位符参数。</p>
<h5 id="querycontext-example">QueryContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">47
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;strings&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">age</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">27</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">rows</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;SELECT name FROM users WHERE age=?&#34;</span>, <span style="color:#e06c75">age</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">names</span> <span style="color:#56b6c2">:=</span> <span style="color:#e5c07b">make</span>([]<span style="color:#e5c07b">string</span>, <span style="color:#d19a66">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Next</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> <span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#7f848e">// Check for a scan error.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>			<span style="color:#7f848e">// Query rows will be closed with defer.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">names</span> = <span style="color:#e5c07b">append</span>(<span style="color:#e06c75">names</span>, <span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// If the database is being written to ensure to check for Close
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// errors that may be returned from the driver. The query may
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// encounter an auto-commit error and be forced to rollback changes.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">rerr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">rerr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">rerr</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Rows.Err will report the last error encountered by Rows.Scan.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Err</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;%s are %d years old&#34;</span>, <span style="color:#e06c75">strings</span>.<span style="color:#61afef;font-weight:bold">Join</span>(<span style="color:#e06c75">names</span>, <span style="color:#98c379">&#34;, &#34;</span>), <span style="color:#e06c75">age</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-queryrowhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1817">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1817" target="_blank" rel="noopener">QueryRow</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">QueryRow</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRow方法执行一个预期返回最多一行的查询。QueryRow方法总是返回一个非空值。错误将被延迟直到调用 Row 的 Scan 方法。如果查询未选择任何行，则 <code>*Row</code> 的 Scan 将返回 ErrNoRows。否则，<code>*Row</code> 的 Scan 扫描第一行并丢弃其余行。</p>
<p>​	QueryRow方法内部使用 context.Background。要指定上下文，请使用 QueryRowContext方法。</p>
<h4 id="db-queryrowcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1803----go18">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1803" target="_blank" rel="noopener">QueryRowContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRowContext方法执行一个预期返回最多一行的查询。QueryRowContext 总是返回一个非空值。错误将被延迟直到调用 Row 的 Scan 方法。如果查询未选择任何行，则 <code>*Row</code> 的 Scan 将返回 ErrNoRows。否则，<code>*Row</code> 的 Scan 扫描第一行并丢弃其余行。</p>
<h5 id="queryrowcontext-example">QueryRowContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">123</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">username</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">created</span> <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Time</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;SELECT username, created_at FROM users WHERE id=?&#34;</span>, <span style="color:#e06c75">id</span>).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">username</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">created</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">switch</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">ErrNoRows</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;no user with id %d\n&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;query error: %v\n&#34;</span>, <span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">default</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;username is %q, account created on %s\n&#34;</span>, <span style="color:#e06c75">username</span>, <span style="color:#e06c75">created</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="db-setconnmaxidletimehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1026----go115">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1026" target="_blank" rel="noopener">SetConnMaxIdleTime</a>  &lt;- go1.15</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">SetConnMaxIdleTime</span>(<span style="color:#e06c75">d</span> <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Duration</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SetConnMaxIdleTime方法设置连接的最大空闲时间。</p>
<p>​	过期的连接可能会在重新使用之前被懒惰地关闭。</p>
<p>​	如果d &lt;= 0，则连接不会因连接的空闲时间而关闭。</p>
<h4 id="db-setconnmaxlifetimehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1004----go16">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1004" target="_blank" rel="noopener">SetConnMaxLifetime</a>  &lt;- go1.6</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">SetConnMaxLifetime</span>(<span style="color:#e06c75">d</span> <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Duration</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SetConnMaxLifetime方法设置连接可以被重用的最长时间。</p>
<p>​	到期的连接可能会在重用之前被懒惰地关闭。</p>
<p>​	如果d &lt;= 0，则不会因连接的年龄而关闭连接。</p>
<h4 id="db-setmaxidleconnshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol952----go11">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=952" target="_blank" rel="noopener">SetMaxIdleConns</a>  &lt;- go1.1</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">SetMaxIdleConns</span>(<span style="color:#e06c75">n</span> <span style="color:#e5c07b">int</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SetMaxIdleConns方法设置空闲连接池中的最大连接数。</p>
<p>​	如果MaxOpenConns大于0但小于新的MaxIdleConns，则新的MaxIdleConns将被减少以匹配MaxOpenConns限制。</p>
<p>​	如果n &lt;= 0，则不会保留空闲连接。</p>
<p>​	默认的最大空闲连接数当前为2。这可能会在将来的版本中更改。</p>
<h4 id="db-setmaxopenconnshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol986----go12">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=986" target="_blank" rel="noopener">SetMaxOpenConns</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">SetMaxOpenConns</span>(<span style="color:#e06c75">n</span> <span style="color:#e5c07b">int</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SetMaxOpenConns方法设置打开到数据库的最大连接数。</p>
<p>​	如果MaxIdleConns大于0且新的MaxOpenConns小于MaxIdleConns，则MaxIdleConns将被减少以匹配新的MaxOpenConns限制。</p>
<p>​	如果n &lt;= 0，则没有打开连接的数量限制。默认值为0(无限制)。</p>
<h4 id="db-statshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1172----go15">(*DB) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1172" target="_blank" rel="noopener">Stats</a>  &lt;- go1.5</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">DB</span>) <span style="color:#61afef;font-weight:bold">Stats</span>() <span style="color:#e06c75">DBStats</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Stats方法返回数据库统计信息。</p>
<h3 id="type-dbstatshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol1155----go15">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=1155" target="_blank" rel="noopener">DBStats</a>  &lt;- go1.5</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">DBStats</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">MaxOpenConnections</span> <span style="color:#e5c07b">int</span> <span style="color:#7f848e">//打开到数据库的最大连接数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 池状态
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">OpenConnections</span> <span style="color:#e5c07b">int</span> <span style="color:#7f848e">// 在使用和空闲中建立的连接数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">InUse</span>           <span style="color:#e5c07b">int</span> <span style="color:#7f848e">// 当前正在使用的连接数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Idle</span>            <span style="color:#e5c07b">int</span> <span style="color:#7f848e">// 空闲连接数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 计数器
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">WaitCount</span>         <span style="color:#e5c07b">int64</span>         <span style="color:#7f848e">// 等待新连接的总数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">WaitDuration</span>      <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Duration</span> <span style="color:#7f848e">// 阻止等待新连接的总时间。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">MaxIdleClosed</span>     <span style="color:#e5c07b">int64</span> <span style="color:#7f848e">// 由于SetMaxIdleConns而关闭的连接总数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">MaxIdleTimeClosed</span> <span style="color:#e5c07b">int64</span> <span style="color:#7f848e">// 由于SetConnMaxIdleTime而关闭的连接总数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">MaxLifetimeClosed</span> <span style="color:#e5c07b">int64</span> <span style="color:#7f848e">// 由于SetConnMaxLifetime而关闭的连接总数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	DBStats包含数据库统计信息。</p>
<h3 id="type-isolationlevelhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol119----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=119" target="_blank" rel="noopener">IsolationLevel</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">IsolationLevel</span> <span style="color:#e5c07b">int</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	IsolationLevel是在TxOptions中使用的事务隔离级别。</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">const</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelDefault</span> <span style="color:#e06c75">IsolationLevel</span> = <span style="color:#e5c07b">iota</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelReadUncommitted</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelReadCommitted</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelWriteCommitted</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelRepeatableRead</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelSnapshot</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelSerializable</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">LevelLinearizable</span>
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	各种隔离级别，驱动程序可以在BeginTx中支持。如果驱动程序不支持给定的隔离级别，则可能返回错误。</p>
<p>​	参见https://en.wikipedia.org/wiki/Isolation_(database_systems)#Isolation_levels。</p>
<h4 id="isolationlevel-stringhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol137----go111">(IsolationLevel) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=137" target="_blank" rel="noopener">String</a>  &lt;- go1.11</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">i</span> <span style="color:#e06c75">IsolationLevel</span>) <span style="color:#61afef;font-weight:bold">String</span>() <span style="color:#e5c07b">string</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	String 函数返回事务隔离级别的名称。</p>
<h3 id="type-namedarghttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol81----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=81" target="_blank" rel="noopener">NamedArg</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NamedArg</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Name 是参数占位符的名称。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 如果为空，则使用参数列表中的序号。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// Name 必须省略任何符号前缀。	
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Value 是参数的值。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 它可以被赋予与查询参数相同的值类型。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Value</span> <span style="color:#e06c75">any</span>
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NamedArg 是一个命名参数。NamedArg 值可以作为参数传递给 Query 或 Exec 并绑定到 SQL 语句中相应的命名参数。</p>
<p>​	为了更简洁地创建 NamedArg 值，请参考 Named 函数。</p>
<h4 id="func-namedhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol110----go18">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=110" target="_blank" rel="noopener">Named</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e06c75">NamedArg</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Named 函数提供了一种更简洁的方式来创建 NamedArg 值。</p>
<p>Example usage:</p>
<p>使用示例：</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">`
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">    delete from Invoice
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">    where
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">        TimeCreated &lt; @end
</span></span></span><span style="display:flex;"><span><span style="color:#98c379">        and TimeCreated &gt;= @start;`</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#98c379">&#34;start&#34;</span>, <span style="color:#e06c75">startTime</span>),
</span></span><span style="display:flex;"><span>    <span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#98c379">&#34;end&#34;</span>, <span style="color:#e06c75">endTime</span>),
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="type-nullboolhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol345">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=345" target="_blank" rel="noopener">NullBool</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullBool</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Bool</span>  <span style="color:#e5c07b">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span> <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果Bool不是NULL，Valid为真。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullBool结构体表示可能为空的 bool 值。NullBool 实现了 Scanner 接口，因此它可以用作扫描目标，类似于 NullString。</p>
<h4 id="nullbool-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol351">(*NullBool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=351" target="_blank" rel="noopener">Scan</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullBool</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现了 Scanner 接口。</p>
<h4 id="nullbool-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol361">(NullBool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=361" target="_blank" rel="noopener">Value</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullBool</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现了 driver Valuer 接口。</p>
<h3 id="type-nullbytehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol292----go117">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=292" target="_blank" rel="noopener">NullByte</a>  &lt;- go1.17</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullByte</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Byte</span>  <span style="color:#e5c07b">byte</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span> <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果 Byte 不为 NULL，则 Valid 为 true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullByte结构体表示一个可能为空的 byte。NullByte 实现了 Scanner 接口，因此它可以像 NullString 一样用作扫描目标。</p>
<h4 id="nullbyte-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol298----go117">(*NullByte) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=298" target="_blank" rel="noopener">Scan</a>  &lt;- go1.17</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullByte</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现了 Scanner 接口。</p>
<h4 id="nullbyte-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol309----go117">(NullByte) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=309" target="_blank" rel="noopener">Value</a>  &lt;- go1.17</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullByte</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现了 driver Valuer 接口。</p>
<h3 id="type-nullfloat64httpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol319">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=319" target="_blank" rel="noopener">NullFloat64</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullFloat64</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Float64</span> <span style="color:#e5c07b">float64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span>   <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果 Float64 不为 NULL，则 Valid 为 true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullFloat64结构体表示一个可能为空的 float64。NullFloat64 实现了 Scanner 接口，因此它可以像 NullString 一样用作扫描目标。</p>
<h4 id="nullfloat64-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol325">(*NullFloat64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=325" target="_blank" rel="noopener">Scan</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullFloat64</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现了 Scanner 接口。</p>
<h4 id="nullfloat64-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol335">(NullFloat64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=335" target="_blank" rel="noopener">Value</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullFloat64</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现了 driver Valuer 接口。</p>
<h3 id="type-nullint16httpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol265----go117">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=265" target="_blank" rel="noopener">NullInt16</a>  &lt;- go1.17</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullInt16</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Int16</span> <span style="color:#e5c07b">int16</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span> <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果Int16不是NULL，Valid为true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullInt16结构体表示可能为null的int16。NullInt16实现Scanner接口，因此它可以用作扫描目标，类似于NullString。</p>
<h4 id="nullint16-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol271----go117">(*NullInt16) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=271" target="_blank" rel="noopener">Scan</a>  &lt;- go1.17</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullInt16</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现Scanner接口。</p>
<h4 id="nullint16-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol282----go117">(NullInt16) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=282" target="_blank" rel="noopener">Value</a>  &lt;- go1.17</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullInt16</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现driver Valuer接口。</p>
<h3 id="type-nullint32httpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol239----go113">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=239" target="_blank" rel="noopener">NullInt32</a>  &lt;- go1.13</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullInt32</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Int32</span> <span style="color:#e5c07b">int32</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span> <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">//如果Int32不是NULL，Valid为true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullInt32结构体表示可能为null的int32。NullInt32实现Scanner接口，因此它可以用作扫描目标，类似于NullString。</p>
<h4 id="nullint32-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol245----go113">(*NullInt32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=245" target="_blank" rel="noopener">Scan</a>  &lt;- go1.13</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullInt32</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现Scanner接口。</p>
<h4 id="nullint32-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol255----go113">(NullInt32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=255" target="_blank" rel="noopener">Value</a>  &lt;- go1.13</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullInt32</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现driver Valuer接口。</p>
<h3 id="type-nullint64httpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol213">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=213" target="_blank" rel="noopener">NullInt64</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullInt64</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Int64</span> <span style="color:#e5c07b">int64</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span> <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果Int64不是NULL，Valid为true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullInt64结构体表示可能为null的int64。NullInt64实现Scanner接口，因此它可以用作扫描目标，类似于NullString。</p>
<h4 id="nullint64-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol219">(*NullInt64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=219" target="_blank" rel="noopener">Scan</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullInt64</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现Scanner接口。</p>
<h4 id="nullint64-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol229">(NullInt64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=229" target="_blank" rel="noopener">Value</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullInt64</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现driver Valuer接口。</p>
<h3 id="type-nullstringhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol187">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=187" target="_blank" rel="noopener">NullString</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullString</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">String</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span>  <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果 String 不为 NULL，则 Valid 为 true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullString结构体表示可能为 null 的字符串。NullString 实现了 Scanner 接口，因此可以用作扫描目标：</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">s</span> <span style="color:#e06c75">NullString</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">QueryRow</span>(<span style="color:#98c379">&#34;SELECT name FROM foo WHERE id=?&#34;</span>, <span style="color:#e06c75">id</span>).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">s</span>)
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">...</span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">if</span> <span style="color:#e06c75">s</span>.<span style="color:#e06c75">Valid</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#7f848e">// use s.String
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>} <span style="color:#c678dd">else</span> {
</span></span><span style="display:flex;"><span>   <span style="color:#7f848e">// NULL value
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="nullstring-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol193">(*NullString) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=193" target="_blank" rel="noopener">Scan</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ns</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullString</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现了 Scanner 接口。</p>
<h4 id="nullstring-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol203">(NullString) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=203" target="_blank" rel="noopener">Value</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">ns</span> <span style="color:#e06c75">NullString</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现了 driver Valuer 接口。</p>
<h3 id="type-nulltimehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol371----go113">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=371" target="_blank" rel="noopener">NullTime</a>  &lt;- go1.13</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NullTime</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Time</span>  <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Time</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Valid</span> <span style="color:#e5c07b">bool</span> <span style="color:#7f848e">// 如果 Time 不为 NULL，则 Valid 为 true
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NullTime结构体表示可能为 null 的 time.Time。NullTime 实现了 Scanner 接口，因此可以用作扫描目标，类似于 NullString。</p>
<h4 id="nulltime-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol377----go113">(*NullTime) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=377" target="_blank" rel="noopener">Scan</a>  &lt;- go1.13</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">NullTime</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法实现了 Scanner 接口。</p>
<h4 id="nulltime-valuehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol387----go113">(NullTime) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=387" target="_blank" rel="noopener">Value</a>  &lt;- go1.13</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NullTime</span>) <span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">driver</span>.<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value方法实现了 driver Valuer 接口。</p>
<h3 id="type-outhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol425----go19">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=425" target="_blank" rel="noopener">Out</a>  &lt;- go1.9</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Out</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Dest is a pointer to the value that will be set to the result of the
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// stored procedure&#39;s OUTPUT parameter.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// Dest是一个指向将被设置为存储过程OUTPUT参数结果的值的指针。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Dest</span> <span style="color:#e06c75">any</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// In is whether the parameter is an INOUT parameter. If so, the input value to the stored
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// procedure is the dereferenced value of Dest&#39;s pointer, which is then replaced with
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// the output value.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// In是指该参数是否为INOUT参数。如果是的话，存储过程的输入值是Dest指针的解引用值，然后用输出值替换。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">In</span> <span style="color:#e5c07b">bool</span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//包含过滤过的或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Out结构体可用于从存储过程中检索 OUTPUT 值参数。</p>
<p>​	并非所有驱动程序和数据库都支持 OUTPUT 值参数。</p>
<p>使用示例：</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">outArg</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">_</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;ProcName&#34;</span>, <span style="color:#e06c75">sql</span>.<span style="color:#61afef;font-weight:bold">Named</span>(<span style="color:#98c379">&#34;Arg1&#34;</span>, <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">Out</span>{<span style="color:#e06c75">Dest</span>: <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">outArg</span>}))
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="type-rawbyteshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol173">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=173" target="_blank" rel="noopener">RawBytes</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RawBytes</span> []<span style="color:#e5c07b">byte</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RawBytes 是一个字节切片，它持有数据库本身拥有的内存引用。将 RawBytes扫描后，该切片仅在下一次调用 Next方法、Scan方法或 Close方法之前有效。</p>
<h3 id="type-resulthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3365">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3365" target="_blank" rel="noopener">Result</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Result</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// LastInsertId 返回数据库在响应命令时生成的整数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 通常这将来自插入新行时的&#34;自增&#34;列。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 不是所有数据库都支持此功能，并且此类语句的语法各不相同。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">LastInsertId</span>() (<span style="color:#e5c07b">int64</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// RowsAffected 返回受更新、插入或删除影响的行数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 并非所有数据库或数据库驱动程序都支持此功能。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">RowsAffected</span>() (<span style="color:#e5c07b">int64</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Result 是对执行的 SQL 命令的摘要。</p>
<h3 id="type-rowhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3306">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3306" target="_blank" rel="noopener">Row</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Row</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Row结构体是调用 QueryRow方法选择单行时的结果。</p>
<h4 id="row-errhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3360----go115">(*Row) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3360" target="_blank" rel="noopener">Err</a>  &lt;- go1.15</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">r</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>) <span style="color:#61afef;font-weight:bold">Err</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Err方法提供了一种方法，使封装的包在不调用 Scan方法的情况下检查查询错误。如果在运行查询时遇到错误，Err 返回错误(如果有)。如果此错误不是 nil，则还将从 Scan 返回此错误。</p>
<h4 id="row-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3317">(*Row) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3317" target="_blank" rel="noopener">Scan</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">r</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">dest</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法将匹配的行中的列复制到 dest 指向的值中。有关详细信息，请参见 Rows.Scan 的文档。如果有多行与查询匹配，则 Scan方法使用第一行并且忽略其余的行。如果没有行与查询匹配，则 Scan方法返回 ErrNoRows。</p>
<h3 id="type-rowshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2882">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2882" target="_blank" rel="noopener">Rows</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Rows</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Rowsjgt是查询的结果。它的游标在结果集的第一行之前。使用 Next方法来从一行移到另一行。</p>
<h5 id="rows-example">Rows Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;strings&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">age</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">27</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">rows</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;SELECT name FROM users WHERE age=?&#34;</span>, <span style="color:#e06c75">age</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">names</span> <span style="color:#56b6c2">:=</span> <span style="color:#e5c07b">make</span>([]<span style="color:#e5c07b">string</span>, <span style="color:#d19a66">0</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Next</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">var</span> <span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">names</span> = <span style="color:#e5c07b">append</span>(<span style="color:#e06c75">names</span>, <span style="color:#e06c75">name</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Check for errors from iterating over rows.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">rows</span>.<span style="color:#61afef;font-weight:bold">Err</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;%s are %d years old&#34;</span>, <span style="color:#e06c75">strings</span>.<span style="color:#61afef;font-weight:bold">Join</span>(<span style="color:#e06c75">names</span>, <span style="color:#98c379">&#34;, &#34;</span>), <span style="color:#e06c75">age</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="rows-closehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3269">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3269" target="_blank" rel="noopener">Close</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Close方法方法关闭 Rows，防止进一步枚举。如果调用 Next 并且返回 false，并且没有其他结果集，则 Rows 将自动关闭，并且检查 Err 的结果就足够了。Close方法是幂等的，不会影响 Err 的结果。</p>
<h4 id="rows-columntypeshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3067----go18">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3067" target="_blank" rel="noopener">ColumnTypes</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">ColumnTypes</span>() ([]<span style="color:#56b6c2">*</span><span style="color:#e06c75">ColumnType</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ColumnTypes方法返回列信息，例如列类型、长度和可空性。某些信息可能不适用于某些驱动程序。</p>
<h4 id="rows-columnshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3050">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3050" target="_blank" rel="noopener">Columns</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">Columns</span>() ([]<span style="color:#e5c07b">string</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Columns方法返回列名。如果行已关闭，则 Columns方法返回错误。</p>
<h4 id="rows-errhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3039">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3039" target="_blank" rel="noopener">Err</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">Err</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Err方法返回迭代过程中遇到的错误(如果有)。Err方法可以在显式或隐式 Close 后调用。</p>
<h4 id="rows-nexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2949">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2949" target="_blank" rel="noopener">Next</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">Next</span>() <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Next方法准备下一个结果行以供 Scan 方法读取。它返回 true 表示成功，false 表示没有下一个结果行或准备它时发生错误。应该使用 Err 来区分这两种情况。</p>
<p>​	每次调用 Scan方法，即使是第一次调用，也必须先调用 Next方法。</p>
<h4 id="rows-nextresultsethttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3003----go18">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3003" target="_blank" rel="noopener">NextResultSet</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">NextResultSet</span>() <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NextResultSet方法准备下一个结果集以供读取。它返回 true 表示还有其他结果集，或者 false 表示没有其他结果集，或者无法提前到其结果集。应该使用 Err 方法来区分这两种情况。</p>
<p>​	在调用 NextResultSet方法后，应始终在扫描之前调用 Next 方法。如果还有其他结果集，则它们可能没有结果集中的行。</p>
<h4 id="rows-scanhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol3232">(*Rows) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=3232" target="_blank" rel="noopener">Scan</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rs</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>) <span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">dest</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scan方法将当前行的列复制到 dest 指向的值中。dest 中的值数量必须与 Rows 中的列数相同。</p>
<p>​	Scan方法将从数据库中读取的列转换为 sql 包提供的以下常见 Go 类型和特殊类型：</p>
<pre tabindex="0"><code>*string
*[]byte
*int, *int8, *int16, *int32, *int64
*uint, *uint8, *uint16, *uint32, *uint64
*bool
*float32, *float64
*interface{}
*RawBytes
*Rows (cursor value)
any type implementing Scanner (see Scanner docs)
</code></pre><p>​	实现 Scanner 接口的任何类型(请参见 Scanner 文档) 在最简单的情况下，如果源列的值类型是整数、布尔或字符串类型 T，而 dest 的类型是 *T，则 Scan 只需通过指针分配值。</p>
<p>​	Scan 还可以在字符串和数字类型之间进行转换，只要不会丢失信息即可。虽然 Scan 将从数值数据库列中读取的所有数字字符串化为 *string，但会检查是否存在数字类型的扫描溢出。例如，值为 300 的 float64 或值为 &ldquo;300&rdquo; 的字符串可以扫描到 uint16，但不能扫描到 uint8，尽管 float64(255) 或 &ldquo;255&rdquo; 可以扫描到 uint8。有一个例外，即某些 float64 数字扫描为字符串时可能会丢失信息。通常，将浮点列扫描到 *float64 中。</p>
<p>​	如果 dest 参数的类型为 *[]byte，则 Scan 会在该参数中保存相应数据的副本。该副本由调用方拥有，可以进行修改并无限期保留。可以通过使用类型 *RawBytes 的参数来避免复制；请参阅 RawBytes 的文档以了解其使用限制。</p>
<p>​	如果一个参数的类型是 *interface{}，Scan 会复制由底层驱动程序提供的值，而不进行转换。从类型 []byte 到 *interface{} 扫描时，会复制切片并且调用方拥有结果。</p>
<p>​	类型 time.Time 的源值可以扫描到类型 *time.Time、*interface{}、*string 或 *[]byte 的值中。转换为后两者时，使用 time.RFC3339Nano。</p>
<p>​	布尔类型的源值可以扫描到类型 *bool、*interface{}、<em>string、</em>[]byte 或 *RawBytes 中。</p>
<p>​	对于扫描到 *bool，源可以是 true、false、1、0 或可由 strconv.ParseBool 解析的字符串输入。</p>
<p>​	Scan 还可以将查询返回的游标(例如 &ldquo;select cursor(select * from my_table) from dual&rdquo;)转换为 *Rows 值，该值本身可以进行扫描。如果父选择查询关闭了任何游标 *Rows，则父选择查询将关闭它。</p>
<p>​	如果实现 Scanner 接口的第一个参数返回错误，则该错误将包装在返回的错误中。</p>
<h3 id="type-scannerhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol395">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=395" target="_blank" rel="noopener">Scanner</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Scanner</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Scan从数据库驱动程序中分配一个值。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// src值将是以下类型之一：
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// int64
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// float64
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// bool
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// []byte
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// string
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// time.Time
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// nil - 对于NULL值
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 如果不能存储值而不丢失信息，则应返回错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 诸如[]byte之类的引用类型仅在下一次调用Scan之前有效，不应保留。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 它们的底层内存由驱动程序拥有。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 如果需要保留，则在下一次调用Scan之前复制其值。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#e06c75">src</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Scanner是由Scan使用的接口。</p>
<h3 id="type-stmthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2558">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2558" target="_blank" rel="noopener">Stmt</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Stmt</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Stmt结构体是一个预处理语句。Stmt对于多个goroutine并发使用是安全的。</p>
<p>​	如果在Tx或Conn上准备了Stmt，则将永远绑定到单个底层连接。 如果Tx或Conn关闭，则Stmt将变得无法使用，所有操作都将返回错误。 如果在DB上准备了Stmt，则在DB的生命周期内将保持可用。当Stmt需要在新的底层连接上执行时， 它将自动在新连接上准备自己。</p>
<h5 id="stmt-example">Stmt Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// In normal use, create one Stmt when your process starts.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">stmt</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">PrepareContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;SELECT username FROM users WHERE id = ?&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Then reuse it each time you need to issue the query.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">43</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">username</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">err</span> = <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">id</span>).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">username</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">switch</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">ErrNoRows</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;no user with id %d&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">default</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;username is %s\n&#34;</span>, <span style="color:#e06c75">username</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="stmt-closehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2837">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2837" target="_blank" rel="noopener">Close</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Close方法关闭该语句。</p>
<h4 id="stmt-exechttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2622">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2622" target="_blank" rel="noopener">Exec</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Exec方法使用给定的参数执行预处理语句，并返回概括语句效果的Result。</p>
<p>​	Exec方法在内部使用context.Background。要指定上下文，请使用ExecContext方法。</p>
<h4 id="stmt-execcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2598----go18">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2598" target="_blank" rel="noopener">ExecContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ExecContext方法使用给定的参数执行预处理语句，并返回概括语句效果的Result。</p>
<h4 id="stmt-queryhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2790">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2790" target="_blank" rel="noopener">Query</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Query方法使用给定的参数执行预处理查询语句，并将查询结果作为<code>*Rows</code>返回。</p>
<p>​	Query方法在内部使用context.Background。要指定上下文，请使用QueryContext方法。</p>
<h4 id="stmt-querycontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2738----go18">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2738" target="_blank" rel="noopener">QueryContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryContext方法使用给定的参数执行预处理查询语句，并将查询结果作为<code>*Rows</code>返回。</p>
<h4 id="stmt-queryrowhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2832">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2832" target="_blank" rel="noopener">QueryRow</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">QueryRow</span>(<span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRow方法使用给定的参数执行预处理的查询语句。如果在执行语句期间出现错误，则通过对返回的<code>*Row调</code>用Scan返回该错误，该<code>*Row</code>始终非零。如果查询未选择任何行，则<code>*Row</code>的Scan将返回ErrNoRows。否则，<code>*Row</code>的Scan将扫描第一个选定的行并丢弃其余行。</p>
<p>使用示例：</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">nameByUseridStmt</span>.<span style="color:#61afef;font-weight:bold">QueryRow</span>(<span style="color:#e06c75">id</span>).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">name</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRow方法在内部使用context.Background；要指定上下文，请使用QueryRowContext方法。</p>
<h4 id="stmt-queryrowcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2810----go18">(*Stmt) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2810" target="_blank" rel="noopener">QueryRowContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">s</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRowContext方法使用给定的参数执行预处理的查询语句。如果在执行语句期间出现错误，则通过对返回的<code>*Row</code>调用Scan返回该错误，该<code>*Row</code>始终非零。如果查询未选择任何行，则<code>*Row</code>的Scan将返回ErrNoRows。否则，<code>*Row</code>的Scan将扫描第一个选定的行并丢弃其余行。</p>
<h5 id="queryrowcontext-example-1">QueryRowContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// In normal use, create one Stmt when your process starts.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">stmt</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">PrepareContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;SELECT username FROM users WHERE id = ?&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">Close</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Then reuse it each time you need to issue the query.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">43</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">username</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">err</span> = <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">id</span>).<span style="color:#61afef;font-weight:bold">Scan</span>(<span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">username</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">switch</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">==</span> <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">ErrNoRows</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;no user with id %d&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">case</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">default</span>:
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Printf</span>(<span style="color:#98c379">&#34;username is %s\n&#34;</span>, <span style="color:#e06c75">username</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="type-txhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2121">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2121" target="_blank" rel="noopener">Tx</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Tx</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 包含已过滤或未导出的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Tx结构体是数据库事务中的一个过程。</p>
<p>​	事务必须以Commit方法或Rollback方法的调用结束。</p>
<p>​	在调用Commit方法或Rollback方法之后，所有事务上的操作都会失败并返回ErrTxDone。</p>
<p>​	通过调用事务的Prepare方法或Stmt方法方法准备的语句将在调用Commit方法或Rollback方法时关闭。</p>
<h4 id="tx-commithttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2242">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2242" target="_blank" rel="noopener">Commit</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">Commit</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Commit方法提交事务。</p>
<h4 id="tx-exechttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2479">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2479" target="_blank" rel="noopener">Exec</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Exec方法执行不返回行的查询。例如：INSERT和UPDATE。</p>
<p>​	Exec方法在内部使用context.Background；要指定上下文，请使用ExecContext方法。</p>
<h4 id="tx-execcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2466----go18">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2466" target="_blank" rel="noopener">ExecContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ExecContext方法执行不返回行的查询。例如：INSERT和UPDATE。</p>
<h5 id="execcontext-example-2">ExecContext Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">TxOptions</span>{<span style="color:#e06c75">Isolation</span>: <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">LevelSerializable</span>})
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">37</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">_</span>, <span style="color:#e06c75">execErr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;UPDATE users SET status = ? WHERE id = ?&#34;</span>, <span style="color:#98c379">&#34;paid&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">execErr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">rollbackErr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Rollback</span>(); <span style="color:#e06c75">rollbackErr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;update failed: %v, unable to rollback: %v\n&#34;</span>, <span style="color:#e06c75">execErr</span>, <span style="color:#e06c75">rollbackErr</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;update failed: %v&#34;</span>, <span style="color:#e06c75">execErr</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Commit</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="tx-preparehttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2352">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2352" target="_blank" rel="noopener">Prepare</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Prepare方法创建一个准备好的语句以在事务中使用。</p>
<p>​	返回的语句在事务中运行，并将在事务提交或回滚时关闭。</p>
<p>​	要在此事务上使用现有的准备好的语句，请参见Tx.Stmt。</p>
<p>​	Prepare方法在内部使用context.Background; 要指定上下文，请使用PrepareContext。</p>
<h5 id="prepare-example-1">Prepare Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">db</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">projects</span> <span style="color:#56b6c2">:=</span> []<span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">mascot</span>  <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">release</span> <span style="color:#e5c07b">int</span>
</span></span><span style="display:flex;"><span>	}{
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;tux&#34;</span>, <span style="color:#d19a66">1991</span>},
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;duke&#34;</span>, <span style="color:#d19a66">1996</span>},
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;gopher&#34;</span>, <span style="color:#d19a66">2009</span>},
</span></span><span style="display:flex;"><span>		{<span style="color:#98c379">&#34;moby dock&#34;</span>, <span style="color:#d19a66">2013</span>},
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Begin</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Rollback</span>() <span style="color:#7f848e">// The rollback will be ignored if the tx has been committed later in the function.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">stmt</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#98c379">&#34;INSERT INTO projects(id, mascot, release, category) VALUES( ?, ?, ?, ? )&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">defer</span> <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#7f848e">// Prepared statements take up server resources and should be closed after use.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">id</span>, <span style="color:#e06c75">project</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">range</span> <span style="color:#e06c75">projects</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">_</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">stmt</span>.<span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#e06c75">id</span><span style="color:#56b6c2">+</span><span style="color:#d19a66">1</span>, <span style="color:#e06c75">project</span>.<span style="color:#e06c75">mascot</span>, <span style="color:#e06c75">project</span>.<span style="color:#e06c75">release</span>, <span style="color:#98c379">&#34;open source&#34;</span>); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Commit</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="tx-preparecontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2327----go18">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2327" target="_blank" rel="noopener">PrepareContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">PrepareContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	PrepareContext方法创建一个准备好的语句以在事务中使用。</p>
<p>​	返回的语句在事务中运行，并将在事务提交或回滚时关闭。</p>
<p>​	要在此事务上使用现有的准备好的语句，请参见Tx.Stmt。</p>
<p>​	提供的上下文将用于准备上下文，而不是用于执行返回的语句。返回的语句将在事务上下文中运行。</p>
<h4 id="tx-queryhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2497">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2497" target="_blank" rel="noopener">Query</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Query方法执行返回行的查询，通常是 SELECT。</p>
<p>​	Query方法在内部使用context.Background；要指定上下文，请使用QueryContext方法。</p>
<h4 id="tx-querycontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2484----go18">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2484" target="_blank" rel="noopener">QueryContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) (<span style="color:#56b6c2">*</span><span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryContext方法执行返回行的查询，通常是 SELECT。</p>
<h4 id="tx-queryrowhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2521">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2521" target="_blank" rel="noopener">QueryRow</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">QueryRow</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRow方法执行预期最多返回一行的查询。QueryRow方法总是返回一个非空值。错误被延迟到调用 Row 的 Scan 方法时才会返回。如果查询未选择行，则 *Row 的 Scan 将返回 ErrNoRows。否则，*Row 的 Scan 扫描第一个选择的行并丢弃其余的行。</p>
<p>​	QueryRow方法在内部使用context.Background；要指定上下文，请使用QueryRowContext。</p>
<h4 id="tx-queryrowcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2507----go18">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2507" target="_blank" rel="noopener">QueryRowContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">QueryRowContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> <span style="color:#56b6c2">...</span><span style="color:#e06c75">any</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Row</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryRowContext方法执行预期最多返回一行的查询。QueryRowContext方法总是返回一个非空值。错误被延迟到调用 Row 的 Scan 方法时才会返回。如果查询未选择行，则 <code>*Row</code> 的 Scan 将返回 ErrNoRows。否则，<code>*Row</code> 的 Scan 扫描第一个选择的行并丢弃其余的行。</p>
<h4 id="tx-rollbackhttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2313">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2313" target="_blank" rel="noopener">Rollback</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">Rollback</span>() <span style="color:#e5c07b">error</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Rollback方法中止事务。</p>
<h5 id="rollback-example">Rollback Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;context&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;database/sql&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">db</span>  <span style="color:#56b6c2">*</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">DB</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#56b6c2">&amp;</span><span style="color:#e06c75">sql</span>.<span style="color:#e06c75">TxOptions</span>{<span style="color:#e06c75">Isolation</span>: <span style="color:#e06c75">sql</span>.<span style="color:#e06c75">LevelSerializable</span>})
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">id</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">53</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">_</span>, <span style="color:#e06c75">err</span> = <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;UPDATE drivers SET status = ? WHERE id = ?;&#34;</span>, <span style="color:#98c379">&#34;assigned&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">rollbackErr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Rollback</span>(); <span style="color:#e06c75">rollbackErr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;update drivers: unable to rollback: %v&#34;</span>, <span style="color:#e06c75">rollbackErr</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">_</span>, <span style="color:#e06c75">err</span> = <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#98c379">&#34;UPDATE pickups SET driver_id = $1;&#34;</span>, <span style="color:#e06c75">id</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">if</span> <span style="color:#e06c75">rollbackErr</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Rollback</span>(); <span style="color:#e06c75">rollbackErr</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatalf</span>(<span style="color:#98c379">&#34;update failed: %v, unable to back: %v&#34;</span>, <span style="color:#e06c75">err</span>, <span style="color:#e06c75">rollbackErr</span>)
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">if</span> <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Commit</span>(); <span style="color:#e06c75">err</span> <span style="color:#56b6c2">!=</span> <span style="color:#e5c07b">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">log</span>.<span style="color:#61afef;font-weight:bold">Fatal</span>(<span style="color:#e06c75">err</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="tx-stmthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2460">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2460" target="_blank" rel="noopener">Stmt</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">Stmt</span>(<span style="color:#e06c75">stmt</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Stmt方法从现有语句返回一个事务特定的准备好的语句。</p>
<p>示例：</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#e06c75">updateMoney</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#98c379">&#34;UPDATE balance SET money=money+? WHERE id=?&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">...</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Begin</span>()
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">...</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">res</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">Stmt</span>(<span style="color:#e06c75">updateMoney</span>).<span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#d19a66">123.45</span>, <span style="color:#d19a66">98293203</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	返回的语句在事务中运行，并在事务提交或回滚后关闭。</p>
<p>​	Stmt在内部使用context.Background；要指定上下文，请使用StmtContext。</p>
<h4 id="tx-stmtcontexthttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol2372----go18">(*Tx) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=2372" target="_blank" rel="noopener">StmtContext</a>  &lt;- go1.8</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">tx</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Tx</span>) <span style="color:#61afef;font-weight:bold">StmtContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">stmt</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Stmt</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StmtContext方法从现有语句返回一个事务特定的准备语句。</p>
<p>Example:</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#e06c75">updateMoney</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#98c379">&#34;UPDATE balance SET money=money+? WHERE id=?&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">...</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">tx</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">db</span>.<span style="color:#61afef;font-weight:bold">Begin</span>()
</span></span><span style="display:flex;"><span><span style="color:#56b6c2">...</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">res</span>, <span style="color:#e06c75">err</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">tx</span>.<span style="color:#61afef;font-weight:bold">StmtContext</span>(<span style="color:#e06c75">ctx</span>, <span style="color:#e06c75">updateMoney</span>).<span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#d19a66">123.45</span>, <span style="color:#d19a66">98293203</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	提供的上下文用于准备语句，而不是执行语句。</p>
<p>​	返回的语句在事务中运行，并在事务提交或回滚后关闭。</p>
<h3 id="type-txoptionshttpscsopensourcegooglegogogo1201srcdatabasesqlsqlgol163----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/sql.go;l=163" target="_blank" rel="noopener">TxOptions</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">TxOptions</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Isolation是事务隔离级别。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 如果为零，则使用驱动程序或数据库的默认级别。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Isolation</span> <span style="color:#e06c75">IsolationLevel</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ReadOnly</span>  <span style="color:#e5c07b">bool</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	TxOptions保存在DB.BeginTx中使用的事务选项。</p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-1c627c8ff1bab17a9f5e94758f67eea2">2 - sql/driver</h1>
    
	<h1 id="driver">driver</h1>
<p><a href="https://pkg.go.dev/database/sql/driver@go1.20.1" target="_blank" rel="noopener">https://pkg.go.dev/database/sql/driver@go1.20.1</a></p>
<p>​	driver包定义了数据库驱动需要实现的接口，供sql包使用。</p>
<p>​	大多数代码应该使用 sql 包。</p>
<p>​	驱动程序接口随着时间的推移而发展。驱动程序应该实现 Connector 和 DriverContext 接口。Connector.Connect 和 Driver.Open 方法不应返回 ErrBadConn。如果连接已经处于无效状态(例如已关闭)，则 ErrBadConn 只能从 Validator、SessionResetter 或查询方法中返回。</p>
<p>​	所有 Conn 实现都应该实现以下接口：Pinger、SessionResetter 和 Validator。</p>
<p>​	如果支持命名参数或上下文，则驱动程序的 Conn 应实现：ExecerContext、QueryerContext、ConnPrepareContext 和 ConnBeginTx。</p>
<p>​	为支持自定义数据类型，实现 NamedValueChecker。NamedValueChecker 还允许查询通过返回 ErrRemoveArgument 接受每个查询选项作为参数。</p>
<p>​	如果支持多个结果集，则 Rows 应实现 RowsNextResultSet。如果驱动程序知道返回结果中存在的类型，它应该实现以下接口：RowsColumnTypeScanType、RowsColumnTypeDatabaseTypeName、RowsColumnTypeLength、RowsColumnTypeNullable 和 RowsColumnTypePrecisionScale。给定行值也可以返回 Rows 类型，它可能表示数据库游标值。</p>
<p>​	在将连接归还给连接池之前，如果实现了 IsValid，则会调用 IsValid。在将连接用于另一个查询之前，如果实现了 ResetSession，则会调用 ResetSession。如果连接从未返回给连接池，而是立即重用，则在重用之前调用 ResetSession，但不调用 IsValid。</p>
<h2 id="常量">常量</h2>
<p>This section is empty.</p>
<h2 id="变量">变量</h2>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=55" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">Bool</span> <span style="color:#e06c75">boolType</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Bool是ValueConverter，用于将输入值转换为布尔值。</p>
<p>转换规则如下：</p>
<ul>
<li>布尔值不变</li>
<li>对于整数类型，1为真，0为假，其他整数为错误</li>
<li>对于字符串和[]byte，与strconv.ParseBool相同的规则</li>
<li>所有其他类型都是一个错误</li>
</ul>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=208" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">DefaultParameterConverter</span> <span style="color:#e06c75">defaultConverter</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	DefaultParameterConverter是ValueConverter的默认实现，当Stmt未实现ColumnConverter时使用。</p>
<p>​	DefaultParameterConverter如果IsValue(arg)则直接返回其参数。否则，如果参数实现了Valuer，则使用其Value方法返回一个Value。作为后备，提供的参数的基础类型用于将其转换为Value：基础整数类型转换为int64，浮点数转换为float64，bool，string和[]byte转换为自身。如果参数是nil指针，则ConvertValue返回nil Value。如果参数是非nil指针，则对其进行取消引用，并递归调用ConvertValue。其他类型是一个错误。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=162" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ErrBadConn</span> = <span style="color:#e06c75">errors</span>.<span style="color:#61afef;font-weight:bold">New</span>(<span style="color:#98c379">&#34;driver: bad connection&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	如果驱动程序处于错误状态(例如服务器早期关闭连接)，则驱动程序应返回ErrBadConn，以向sql包发信号。sql包应该在新连接上重试。</p>
<p>​	为了防止重复操作，如果数据库服务器可能执行操作，则不应返回ErrBadConn。即使服务器发送错误，您也不应返回ErrBadConn。</p>
<p>​	使用errors.Is检查错误。一个错误可能包装ErrBadConn或实现Is(error) bool方法。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=385" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ErrRemoveArgument</span> = <span style="color:#e06c75">errors</span>.<span style="color:#61afef;font-weight:bold">New</span>(<span style="color:#98c379">&#34;driver: remove argument from query&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NamedValueChecker可能会返回ErrRemoveArgument，以指示sql包不将参数传递给驱动程序查询接口。在接受特定于查询的选项或不是SQL查询参数的结构时返回。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=148" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ErrSkip</span> = <span style="color:#e06c75">errors</span>.<span style="color:#61afef;font-weight:bold">New</span>(<span style="color:#98c379">&#34;driver: skip fast-path; continue as if unimplemented&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	某些可选接口的方法可能返回ErrSkip，以表示在运行时快速路径不可用，sql包应继续，就像未实现可选接口一样。仅在明确文档中记录了ErrSkip。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=102" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">Int32</span> <span style="color:#e06c75">int32Type</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Int32是ValueConverter，用于将输入值转换为int64，并考虑int32值的限制。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=540" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">ResultNoRows</span> <span style="color:#e06c75">noRows</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ResultNoRows是预定义结果，驱动程序在DDL命令(如CREATE TABLE)成功时返回。它对于LastInsertId和RowsAffected都返回错误。</p>
<p><a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=137" target="_blank" rel="noopener">View Source</a></p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">String</span> <span style="color:#e06c75">stringType</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	String是ValueConverter，用于将其输入转换为字符串。如果该值已经是字符串或[]byte，则不变。如果值是其他类型，则使用fmt.Sprintf(&quot;%v&quot;，v)进行字符串转换。</p>
<h2 id="函数">函数</h2>
<h4 id="func-isscanvaluehttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol191">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=191" target="_blank" rel="noopener">IsScanValue</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">IsScanValue</span>(<span style="color:#e06c75">v</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	IsScanValue函数等价于 IsValue。它存在是为了兼容性。</p>
<h4 id="func-isvaluehttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol176">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=176" target="_blank" rel="noopener">IsValue</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">IsValue</span>(<span style="color:#e06c75">v</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	IsValue函数报告v是否为有效的 Value 参数类型。</p>
<h2 id="类型">类型</h2>
<h3 id="type-connhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol233">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=233" target="_blank" rel="noopener">Conn</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Conn</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Prepare 返回一个准备好的语句，与此连接绑定。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Prepare</span>(<span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Close 使任何当前的准备语句和事务无效，标记此连接不再使用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 因为sql包维护一个空闲连接池，并且仅在空闲连接过多时调用Close，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 所以驱动程序不需要执行自己的连接缓存。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 驱动程序必须确保Close调用所做的所有网络调用不会无限期地阻塞(例如，应用超时)。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Begin 启动并返回一个新的事务。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 已弃用：驱动程序应该实现 ConnBeginTx 代替(或同时实现)。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Begin</span>() (<span style="color:#e06c75">Tx</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Conn 是到数据库的连接。它不会被多个goroutine同时使用。</p>
<p>​	Conn 被认为是有状态的。</p>
<h3 id="type-connbegintxhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol279----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=279" target="_blank" rel="noopener">ConnBeginTx</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">ConnBeginTx</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// BeginTx 启动并返回一个新的事务。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 如果用户取消了上下文，sql包将在丢弃和关闭连接之前调用Tx.Rollback。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 这必须检查opts.Isolation以确定是否有设置隔离级别。如果驱动程序不支持非默认级别，并且已设置一个级别，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 或者存在一个不支持的非默认隔离级别，则必须返回一个错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 这还必须检查opts.ReadOnly以确定只读值是否为true，以设置只读事务属性(如果受支持)，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 或者如果不支持，则返回错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">BeginTx</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">opts</span> <span style="color:#e06c75">TxOptions</span>) (<span style="color:#e06c75">Tx</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ConnBeginTx 使用上下文和 TxOptions 增强了 Conn 接口。</p>
<h3 id="type-connpreparecontexthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol257----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=257" target="_blank" rel="noopener">ConnPrepareContext</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">ConnPrepareContext</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// PrepareContext 返回一个准备好的语句，与此连接绑定。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// context 是用于准备语句的，它不能在语句本身中存储上下文。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">PrepareContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>) (<span style="color:#e06c75">Stmt</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ConnPrepareContext 通过上下文增强 Conn 接口。</p>
<h3 id="type-connectorhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol121----go110">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=121" target="_blank" rel="noopener">Connector</a>  &lt;- go1.10</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Connector</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Connect 返回到数据库的连接。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// Connect 可以返回缓存的连接(先前关闭的连接)，但这样做是不必要的；
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// sql 包维护一个空闲连接池，以便有效地重复使用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 提供的 context.Context 仅用于拨号目的
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//(请参阅 net.DialContext)，不应存储或用于其他目的。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 在拨号时仍应使用默认超时，因为连接池可以异步地调用 Connect 到任何查询。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 返回的连接只由一个 goroutine 使用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Connect</span>(<span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) (<span style="color:#e06c75">Conn</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Driver 返回 Connector 的基础 Driver，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 主要是为了与 sql.DB 上的 Driver 方法保持兼容性。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Driver</span>() <span style="color:#e06c75">Driver</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Connector 表示一个具有固定配置的驱动程序，并可以创建任意数量的等效 Conns 供多个 goroutine 使用。</p>
<p>​	可以将 Connector 传递给 sql.OpenDB，以允许驱动程序实现其自己的 sql.DB 构造函数，或者由 DriverContext 的 OpenConnector 方法返回，以允许驱动程序访问上下文并避免重复解析驱动程序配置。</p>
<p>​	如果 Connector 实现了 io.Closer，则 sql 包的 DB.Close 方法将调用 Close 并返回错误(如果有)。</p>
<h3 id="type-driverhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol84">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=84" target="_blank" rel="noopener">Driver</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Driver</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Open 返回到数据库的新连接。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 名称是驱动程序特定格式的字符串。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// Open 可以返回缓存的连接(先前关闭的连接)，但这样做是不必要的；
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// sql 包维护一个空闲连接池，以便有效地重复使用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 返回的连接只由一个 goroutine 使用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Open</span>(<span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>) (<span style="color:#e06c75">Conn</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Driver 是必须由数据库驱动程序实现的接口。</p>
<p>​	数据库驱动程序可以实现 DriverContext，以便访问上下文并仅解析一次名称以获得连接池，而不是每个连接都解析一次。</p>
<h3 id="type-drivercontexthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol103----go110">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=103" target="_blank" rel="noopener">DriverContext</a>  &lt;- go1.10</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">DriverContext</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// OpenConnector must parse the name in the same format that Driver.Open
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// parses the name parameter.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// OpenConnector必须以Driver.Open解析名称参数的相同格式解析名称。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">OpenConnector</span>(<span style="color:#e06c75">name</span> <span style="color:#e5c07b">string</span>) (<span style="color:#e06c75">Connector</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	如果 Driver 实现了 DriverContext 接口，那么 sql.DB 将调用 OpenConnector 来获取 Connector，并调用该 Connector 的 Connect 方法来获取每个所需的连接，而不是为每个连接调用 Driver 的 Open 方法。这个两步的过程允许驱动程序只解析一次名称，并且提供对每个 Conn 的上下文访问。</p>
<h3 id="type-execercontexthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol198----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=198" target="_blank" rel="noopener">ExecerContext</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">ExecerContext</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> []<span style="color:#e06c75">NamedValue</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	ExecerContext 是一个可选接口，可以由 Conn 实现。</p>
<p>​	如果 Conn 没有实现 ExecerContext，则 sql 包的 DB.Exec 将退回到 Execer；如果 Conn 也没有实现 Execer，则 DB.Exec 将首先准备查询，执行语句，然后关闭语句。</p>
<p>​	ExecContext 可能返回 ErrSkip。</p>
<p>​	ExecContext 必须遵守上下文超时，并在上下文取消时返回。</p>
<h3 id="type-isolationlevelhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol268----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=268" target="_blank" rel="noopener">IsolationLevel</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">IsolationLevel</span> <span style="color:#e5c07b">int</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	IsolationLevel 是存储在 TxOptions 中的事务隔离级别。</p>
<p>​	这个类型应该被认为与 sql.IsolationLevel 相同，以及其上定义的任何值。</p>
<h3 id="type-namedvaluehttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol64----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=64" target="_blank" rel="noopener">NamedValue</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NamedValue</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// 如果 Name 不为空，应该用于参数标识符，而不是位置。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// Name 不会有符号前缀。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Name</span> <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 参数的序号位置，从一开始计数，并始终设置。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Ordinal</span> <span style="color:#e5c07b">int</span>	
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Value是参数的值。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">Value</span> <span style="color:#e06c75">Value</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NamedValue 持有值的名称和值。</p>
<h3 id="type-namedvaluecheckerhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol402----go19">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=402" target="_blank" rel="noopener">NamedValueChecker</a>  &lt;- go1.9</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NamedValueChecker</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// CheckNamedValue 在将参数传递给驱动程序之前调用，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 并在任何 ColumnConverter 的位置调用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// CheckNamedValue 必须做类型验证和转换，以适合驱动程序。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">CheckNamedValue</span>(<span style="color:#56b6c2">*</span><span style="color:#e06c75">NamedValue</span>) <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NamedValueChecker 可以由 Conn 或 Stmt 可选实现。它为驱动程序提供了更多的控制权，以处理超出默认的 Value 类型允许的 Go 和数据库类型。</p>
<p>​	sql包会按照以下顺序检查值检查器，并在找到第一个匹配项时停止：Stmt.NamedValueChecker、Conn.NamedValueChecker、Stmt.ColumnConverter和DefaultParameterConverter。</p>
<p>​	如果CheckNamedValue返回ErrRemoveArgument，则NamedValue不会包含在最终查询参数中。这可用于向查询本身传递特殊选项。</p>
<p>​	如果返回ErrSkip，则对于该参数将使用列转换器错误检查路径。驱动程序可能会在耗尽其自己的特殊情况后返回ErrSkip。</p>
<h3 id="type-notnullhttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol164">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=164" target="_blank" rel="noopener">NotNull</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">NotNull</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Converter</span> <span style="color:#e06c75">ValueConverter</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NotNull结构体是一种类型，通过禁止nil值但否则委托给另一个ValueConverter来实现ValueConverter。</p>
<h4 id="notnull-convertvaluehttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol168">(NotNull) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=168" target="_blank" rel="noopener">ConvertValue</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">NotNull</span>) <span style="color:#61afef;font-weight:bold">ConvertValue</span>(<span style="color:#e06c75">v</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="type-nullhttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol151">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=151" target="_blank" rel="noopener">Null</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Null</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Converter</span> <span style="color:#e06c75">ValueConverter</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Null结构体是一种类型，通过允许nil值但否则委托给另一个ValueConverter来实现ValueConverter。</p>
<h4 id="null-convertvaluehttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol155">(Null) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=155" target="_blank" rel="noopener">ConvertValue</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">n</span> <span style="color:#e06c75">Null</span>) <span style="color:#61afef;font-weight:bold">ConvertValue</span>(<span style="color:#e06c75">v</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="type-pingerhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol171----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=171" target="_blank" rel="noopener">Pinger</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Pinger</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Ping</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Pinger是Conn可能实现的一个可选接口。</p>
<p>​	如果Conn未实现Pinger，则sql包的DB.Ping和DB.PingContext将检查是否至少有一个Conn可用。</p>
<p>​	如果Conn.Ping返回ErrBadConn，则DB.Ping和DB.PingContext将从池中删除Conn。</p>
<h3 id="type-queryercontexthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol225----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=225" target="_blank" rel="noopener">QueryerContext</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">QueryerContext</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">query</span> <span style="color:#e5c07b">string</span>, <span style="color:#e06c75">args</span> []<span style="color:#e06c75">NamedValue</span>) (<span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	QueryerContext是Conn可能实现的一个可选接口。</p>
<p>​	如果Conn未实现QueryerContext，则sql包的DB.Query将回退到Queryer；如果Conn也未实现Queryer，则DB.Query将首先准备查询，执行语句，然后关闭语句。</p>
<p>​	QueryContext可能会返回ErrSkip。</p>
<p>​	QueryContext必须遵守上下文超时并在取消上下文时返回。</p>
<h3 id="type-resulthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol316">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=316" target="_blank" rel="noopener">Result</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Result</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// LastInsertId 返回数据库生成的自增 ID，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 比如在插入一个带有主键的表时。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">LastInsertId</span>() (<span style="color:#e5c07b">int64</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// RowsAffected 返回由查询所影响的行数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">RowsAffected</span>() (<span style="color:#e5c07b">int64</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Result接口表示一个查询操作的结果。</p>
<h3 id="type-rowshttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol423">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=423" target="_blank" rel="noopener">Rows</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Rows</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Columns 返回列的名称。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 结果集中列的数量从切片的长度中推断出来。如果特定列的名称未知，则该项应返回空字符串。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Columns</span>() []<span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Close 关闭行迭代器。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Next 用来将下一行数据填充到提供的切片中。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 提供的切片将与 Columns() 的宽度相同。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// Next 应在没有更多行时返回 io.EOF。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 在 Next 之外不应写入 dest。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 在关闭 Rows 时要小心，以免修改 dest 中保存的缓冲区。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Next</span>(<span style="color:#e06c75">dest</span> []<span style="color:#e06c75">Value</span>) <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Rows接口是一个已执行查询的结果集迭代器。</p>
<h3 id="type-rowsaffectedhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol525">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=525" target="_blank" rel="noopener">RowsAffected</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsAffected</span> <span style="color:#e5c07b">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsAffected 表示执行 INSERT 或 UPDATE 操作所影响的行数，实现了 Result 接口。</p>
<h4 id="rowsaffected-lastinsertidhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol529">(RowsAffected) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=529" target="_blank" rel="noopener">LastInsertId</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">RowsAffected</span>) <span style="color:#61afef;font-weight:bold">LastInsertId</span>() (<span style="color:#e5c07b">int64</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="rowsaffected-rowsaffectedhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol533">(RowsAffected) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=533" target="_blank" rel="noopener">RowsAffected</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">v</span> <span style="color:#e06c75">RowsAffected</span>) <span style="color:#61afef;font-weight:bold">RowsAffected</span>() (<span style="color:#e5c07b">int64</span>, <span style="color:#e5c07b">error</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="type-rowscolumntypedatabasetypenamehttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol474----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=474" target="_blank" rel="noopener">RowsColumnTypeDatabaseTypeName</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsColumnTypeDatabaseTypeName</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Rows</span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">ColumnTypeDatabaseTypeName</span>(<span style="color:#e06c75">index</span> <span style="color:#e5c07b">int</span>) <span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsColumnTypeDatabaseTypeName接口可以被 Rows 实现。它应该返回数据库系统类型名称，但不包括长度信息。类型名称应大写。以下是各种类型的返回示例：&ldquo;VARCHAR&rdquo;、&ldquo;NVARCHAR&rdquo;、&ldquo;VARCHAR2&rdquo;、&ldquo;CHAR&rdquo;、&ldquo;TEXT&rdquo;、&ldquo;DECIMAL&rdquo;、&ldquo;SMALLINT&rdquo;、&ldquo;INT&rdquo;、&ldquo;BIGINT&rdquo;、&ldquo;BOOL&rdquo;、&quot;[]BIGINT&quot;、&ldquo;JSONB&rdquo;、&ldquo;XML&rdquo;、&ldquo;TIMESTAMP&rdquo;。</p>
<h3 id="type-rowscolumntypelengthhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol491----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=491" target="_blank" rel="noopener">RowsColumnTypeLength</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsColumnTypeLength</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Rows</span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">ColumnTypeLength</span>(<span style="color:#e06c75">index</span> <span style="color:#e5c07b">int</span>) (<span style="color:#e06c75">length</span> <span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsColumnTypeLength接口可以被 Rows 实现。如果列是变长类型，则它应返回列类型的长度。如果列不是变长类型，则应该返回 false。如果长度除系统限制外不受限制，则应返回 math.MaxInt64。以下是各种类型的返回示例：</p>
<pre tabindex="0"><code>TEXT          (math.MaxInt64, true)
varchar(10)   (10, true)
nvarchar(10)  (10, true)
decimal       (0, false)
int           (0, false)
bytea(30)     (30, true)
</code></pre><h3 id="type-rowscolumntypenullablehttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol500----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=500" target="_blank" rel="noopener">RowsColumnTypeNullable</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsColumnTypeNullable</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Rows</span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">ColumnTypeNullable</span>(<span style="color:#e06c75">index</span> <span style="color:#e5c07b">int</span>) (<span style="color:#e06c75">nullable</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsColumnTypeNullable接口是由Rows实现的可选接口。如果已知该列可以为null，则可为空值应为true；如果已知该列不可为空，则为空值为false。如果列的可空性未知，则ok应为false。</p>
<h3 id="type-rowscolumntypeprecisionscalehttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol512----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=512" target="_blank" rel="noopener">RowsColumnTypePrecisionScale</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsColumnTypePrecisionScale</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Rows</span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">ColumnTypePrecisionScale</span>(<span style="color:#e06c75">index</span> <span style="color:#e5c07b">int</span>) (<span style="color:#e06c75">precision</span>, <span style="color:#e06c75">scale</span> <span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsColumnTypePrecisionScale接口是由Rows实现的可选接口。它应返回十进制类型的精度和刻度。如果不适用，则应将ok设置为false。以下是各种类型的返回值示例：</p>
<pre tabindex="0"><code>decimal(38, 4)    (38, 4, true)
int               (0, 0, false)
decimal           (math.MaxInt64, math.MaxInt64, true)
</code></pre><h3 id="type-rowscolumntypescantypehttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol464----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=464" target="_blank" rel="noopener">RowsColumnTypeScanType</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsColumnTypeScanType</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Rows</span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">ColumnTypeScanType</span>(<span style="color:#e06c75">index</span> <span style="color:#e5c07b">int</span>) <span style="color:#e06c75">reflect</span>.<span style="color:#e06c75">Type</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsColumnTypeScanType接口是由Rows实现的可选接口。它应返回可以用于扫描类型的值类型。例如，对于数据库列类型&quot;bigint&quot;，这应返回&quot;reflect.TypeOf(int64(0))&quot;。</p>
<h3 id="type-rowsnextresultsethttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol447----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=447" target="_blank" rel="noopener">RowsNextResultSet</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RowsNextResultSet</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Rows</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// HasNextResultSet在当前结果集结束时调用，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 报告当前结果集之后是否还有另一个结果集。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">HasNextResultSet</span>() <span style="color:#e5c07b">bool</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// NextResultSet将驱动程序推进到下一个结果集，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 即使当前结果集还有剩余行。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 当没有更多的结果集时，NextResultSet应该返回io.EOF。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">NextResultSet</span>() <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RowsNextResultSet接口通过提供一种信号方式来扩展Rows接口，以使驱动程序前进到下一个结果集。</p>
<h3 id="type-sessionresetterhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol297----go110">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=297" target="_blank" rel="noopener">SessionResetter</a>  &lt;- go1.10</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">SessionResetter</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// ResetSession在连接之前执行查询时调用，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 如果连接之前已被使用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 如果驱动程序返回ErrBadConn，则连接将被丢弃。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">ResetSession</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>) <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SessionResetter接口可以由Conn实现，以允许驱动程序重置与连接相关的会话状态并发出坏连接信号。</p>
<h3 id="type-stmthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol329">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=329" target="_blank" rel="noopener">Stmt</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Stmt</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Close关闭预处理语句。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 从 Go 1.1 开始，如果预处理语句正在被任何查询使用，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 则不会关闭预处理语句。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 驱动程序必须确保 Close 所做的所有网络调用不会无限期地阻塞(例如，应用超时)。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Close</span>() <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// NumInput 返回占位符参数的数量。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 如果 NumInput 返回 &gt;= 0，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 则 sql 包将检查调用者的参数计数，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 并在调用预处理语句的 Exec 或 Query 方法之前向调用者返回错误。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 如果驱动程序不知道其占位符的数量，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 则 NumInput 也可以返回-1。在这种情况下，
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// sql 包将不会检查 Exec 或 Query 参数计数。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">NumInput</span>() <span style="color:#e5c07b">int</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Exec 执行不返回行的查询，例如 INSERT 或 UPDATE。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 已弃用：驱动程序应该实现 StmtExecContext(或另外实现)。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Exec</span>(<span style="color:#e06c75">args</span> []<span style="color:#e06c75">Value</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Query 执行可能返回行的查询，例如 SELECT。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">//
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// 已弃用：驱动程序应该实现 StmtQueryContext(或另外实现)。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Query</span>(<span style="color:#e06c75">args</span> []<span style="color:#e06c75">Value</span>) (<span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Stmt接口是预处理语句。它绑定到Conn，不能被多个goroutine同时使用。</p>
<h3 id="type-stmtexeccontexthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol364----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=364" target="_blank" rel="noopener">StmtExecContext</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">StmtExecContext</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// ExecContext方法执行不返回行的查询，例如INSERT或UPDATE。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// ExecContext方法必须遵守上下文超时并在取消时返回。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">ExecContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">args</span> []<span style="color:#e06c75">NamedValue</span>) (<span style="color:#e06c75">Result</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StmtExecContext接口通过提供带有上下文的Exec来增强Stmt接口。</p>
<h3 id="type-stmtquerycontexthttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol373----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=373" target="_blank" rel="noopener">StmtQueryContext</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">StmtQueryContext</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// QueryContext方法执行可能返回行的查询，例如SELECT。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// QueryContext方法必须遵守上下文超时并在取消时返回。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">QueryContext</span>(<span style="color:#e06c75">ctx</span> <span style="color:#e06c75">context</span>.<span style="color:#e06c75">Context</span>, <span style="color:#e06c75">args</span> []<span style="color:#e06c75">NamedValue</span>) (<span style="color:#e06c75">Rows</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StmtQueryContext接口通过提供带有上下文的Query来增强Stmt接口。</p>
<h3 id="type-txhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol518">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=518" target="_blank" rel="noopener">Tx</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Tx</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Commit</span>() <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Rollback</span>() <span style="color:#e5c07b">error</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Tx 是事务。</p>
<h3 id="type-txoptionshttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol273----go18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=273" target="_blank" rel="noopener">TxOptions</a>  &lt;- go1.8</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">TxOptions</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">Isolation</span> <span style="color:#e06c75">IsolationLevel</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">ReadOnly</span>  <span style="color:#e5c07b">bool</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	TxOptions结构体存储事务的选项。</p>
<p>​	此类型应被认为与 sql.TxOptions 相同。</p>
<h3 id="type-validatorhttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol309----go115">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=309" target="_blank" rel="noopener">Validator</a>  &lt;- go1.15</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Validator</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// IsValid方法在将连接放入连接池之前调用。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// 如果返回false，则连接将被丢弃。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">IsValid</span>() <span style="color:#e5c07b">bool</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Validator接口可以被 Conn 实现，以允许驱动程序表明连接是否有效或是否应丢弃。</p>
<p>​	如果实现了 Validator，则驱动程序可能会从查询中返回基础错误，即使连接应该由连接池丢弃。</p>
<h3 id="type-valuehttpscsopensourcegooglegogogo1201srcdatabasesqldriverdrivergol61">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/driver.go;l=61" target="_blank" rel="noopener">Value</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Value</span> <span style="color:#e06c75">any</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value类型是驱动程序必须能够处理的值。它可以是 nil、由数据库驱动程序的 NamedValueChecker 接口处理的类型，或是以下类型的实例</p>
<pre tabindex="0"><code>int64
float64
bool
[]byte
string
time.Time
</code></pre><p>​	如果驱动程序支持游标，则返回的 Value 还可以在此包中实现 Rows 接口。例如，当用户选择类似于&quot;select cursor(select * from my_table) from dual&quot;这样的光标时。如果从选择中的 Rows 被关闭，则光标 Rows 也将被关闭。</p>
<h3 id="type-valueconverterhttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol30">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=30" target="_blank" rel="noopener">ValueConverter</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">ValueConverter</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// ConvertValue方法将一个值转换为driver.Value。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">ConvertValue</span>(<span style="color:#e06c75">v</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ValueConverter接口是提供 ConvertValue 方法的接口。</p>
<p>驱动程序包提供了 ValueConverter 的各种实现，以提供驱动程序之间的一致的转换实现。ValueConverter 有以下几个用途：</p>
<ul>
<li>将 sql 包提供的 Value 类型转换为数据库表的特定列类型，并确保其适合，例如确保特定 int64 适合于表的 uint16 列。</li>
<li>将从数据库中给出的值转换为驱动程序 Value 类型之一。</li>
<li>由 sql 包，在扫描中将驱动程序的 Value 类型转换为用户的类型。</li>
</ul>
<h3 id="type-valuerhttpscsopensourcegooglegogogo1201srcdatabasesqldrivertypesgol39">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/database/sql/driver/types.go;l=39" target="_blank" rel="noopener">Valuer</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Valuer</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#7f848e">// Value方法返回一个driver.Value。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>    <span style="color:#7f848e">// Value方法不得panic。
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#61afef;font-weight:bold">Value</span>() (<span style="color:#e06c75">Value</span>, <span style="color:#e5c07b">error</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Valuer接口是提供 Value 方法的接口。</p>
<p>​	实现 Valuer 接口的类型能够将自身转换为驱动程序 Value。</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User mailing list" aria-label="User mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/mail" aria-label="User mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/twitter" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/stack" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/google/docsy" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list" aria-label="Developer mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 The Docsy Authors </small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener"></a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
  <script src="/js/main.min.9069af235eb4d4956fc4dc29e5ca46caef0cdcae593856be4e33c99075bc5ea2.js" integrity="sha256-kGmvI1601JVvxNwp5cpGyu8M3K5ZOFa&#43;TjPJkHW8XqI=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>
<script src='/js/deal-zero-width-space.js'></script>
  </body>
</html>
