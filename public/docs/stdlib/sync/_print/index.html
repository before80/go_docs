<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.111.3">
<link rel="canonical" type="text/html" href="http://ngd.cn/docs/stdLib/sync/">
<link rel="alternate" type="application/rss&#43;xml" href="http://ngd.cn/docs/stdLib/sync/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>sync | go文档集</title>
<meta name="description" content="The most popular HTML, CSS, and JS library in the world.">
<meta property="og:title" content="sync" />
<meta property="og:description" content="The most popular HTML, CSS, and JS library in the world." />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://ngd.cn/docs/stdLib/sync/" />
<meta itemprop="name" content="sync">
<meta itemprop="description" content="The most popular HTML, CSS, and JS library in the world."><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="sync"/>
<meta name="twitter:description" content="The most popular HTML, CSS, and JS library in the world."/>




<link rel="preload" href="/scss/main.min.bb1f3a37154c4661ae02d3cb1a733edd8005db70f626370ca004c689a63ab7d4.css" as="style">
<link href="/scss/main.min.bb1f3a37154c4661ae02d3cb1a733edd8005db70f626370ca004c689a63ab7d4.css" rel="stylesheet" integrity="">

<link href="/css/extra.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-00000000-0');
}
</script>
  </head>
  <body class="td-section">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">go文档集</span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="/docs/"><span class="active">文档</span></a>
      </li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    <div class="td-search">
  <div class="td-search__icon"></div>
  <input type="search" class="td-search__input form-control td-search-input" placeholder="" aria-label="" autocomplete="off">
</div>

  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>

<a href="#" onclick="print();return false;"></a>.
</p><p>
<a href="/docs/stdLib/sync/"></a>.
</p>
</div>



<h1 class="title">sync</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-4cd689eac14b6206d07d927aae970189">atomic</a></li>


    
  
    
    
	
<li>2: <a href="#pg-139625d088b601d2bcbb250c511c8f8b">sync</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-4cd689eac14b6206d07d927aae970189">1 - atomic</h1>
    
	<h1 id="atomic">atomic</h1>
<p><a href="https://pkg.go.dev/sync/atomic@go1.20.1" target="_blank" rel="noopener">https://pkg.go.dev/sync/atomic@go1.20.1</a></p>
<p>​	atomic包提供了低级别的原子内存原语，用于实现同步算法。</p>
<p>​	这些函数需要极其小心地使用才能正确地使用。除非是特殊的低级别应用，否则使用通道或sync包的工具进行同步更好。通过通信共享内存，而不是通过共享内存进行通信。</p>
<p>​	SwapT函数实现的交换操作是以下操作的原子等效操作：</p>
<pre tabindex="0"><code>old = *addr
*addr = new
return old
</code></pre><p>​	CompareAndSwapT函数实现的比较和交换操作是以下操作的原子等效操作：</p>
<pre tabindex="0"><code>if *addr == old {
	*addr = new
	return true
}
return false
</code></pre><p>​	AddT函数实现的添加操作是以下操作的原子等效操作：</p>
<pre tabindex="0"><code>*addr += delta
return *addr
</code></pre><p>​	LoadT和StoreT函数实现的加载和存储操作是&quot;return *addr&quot;和&quot;*addr = val&quot;的原子等效操作。</p>
<p>​	在Go内存模型的术语中，如果原子操作A的效果被原子操作B观察到，则A&quot;在&quot;B之前同步。此外，程序中执行的所有原子操作都像按某些顺序连续执行一样运行。这个定义提供了与C++的顺序一致原子和Java的易失性变量相同的语义。</p>
<h2 id="常量">常量</h2>
<p>This section is empty.</p>
<h2 id="变量">变量</h2>
<p>This section is empty.</p>
<h2 id="函数">函数</h2>
<h4 id="func-addint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol118">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=118" target="_blank" rel="noopener">AddInt32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">AddInt32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int32</span>, <span style="color:#e06c75">delta</span> <span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>AddInt32函数原子地将delta添加到<code>*addr</code>，并返回新值。考虑使用更符合人体工程学和更不容易出错的Int32.Add代替。</p>
<h4 id="func-addint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol129">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=129" target="_blank" rel="noopener">AddInt64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">AddInt64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">delta</span> <span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>AddInt64函数原子地将delta添加到<code>*addr</code>，并返回新值。如果您的目标是32位平台，请考虑使用更符合人体工程学和更不容易出错的Int64.Add代替(请参见错误部分)。</p>
<h4 id="func-adduint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol124">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=124" target="_blank" rel="noopener">AddUint32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">AddUint32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint32</span>, <span style="color:#e06c75">delta</span> <span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	AddUint32函数原子地将delta添加到<code>*addr</code>，并返回新值。要从x减去已知正常数值c，请执行AddUint32(&amp;x，^uint32(c-1))。特别地，要将x减少1，请执行AddUint32(&amp;x，^uint32(0))。考虑使用更符合人体工程学和更不容易出错的Uint32.Add代替。</p>
<h4 id="func-adduint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol136">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=136" target="_blank" rel="noopener">AddUint64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">AddUint64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint64</span>, <span style="color:#e06c75">delta</span> <span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	AddUint64函数原子地将delta添加到<code>*addr</code>，并返回新值。要从x减去已知正常数值c，请执行AddUint64(&amp;x，^uint64(c-1))。特别地，要将x减少1，请执行AddUint64(&amp;x，^uint64(0))。如果您的目标是32位平台，请考虑使用更符合人体工程学和更不容易出错的Uint64.Add代替(请参见错误部分)。</p>
<h4 id="func-adduintptrhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol140">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=140" target="_blank" rel="noopener">AddUintptr</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">AddUintptr</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uintptr</span>, <span style="color:#e06c75">delta</span> <span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	AddUintptr函数原子地将delta添加到<code>*addr</code>，并返回新值。考虑使用更符合人体工程学和更不容易出错的Uintptr.Add代替。</p>
<h4 id="func-compareandswapint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol92">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=92" target="_blank" rel="noopener">CompareAndSwapInt32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CompareAndSwapInt32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int32</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwapInt32函数执行 int32 值的比较并交换操作。建议使用更符合人体工程学和更少容易出错的 Int32.CompareAndSwap。</p>
<h4 id="func-compareandswapint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol97">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=97" target="_blank" rel="noopener">CompareAndSwapInt64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CompareAndSwapInt64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwapInt64函数执行 int64 值的比较并交换操作。建议使用更符合人体工程学和更少容易出错的 Int64.CompareAndSwap (特别是针对 32 位平台；参见错误部分)。</p>
<h4 id="func-compareandswappointerhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol114">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=114" target="_blank" rel="noopener">CompareAndSwapPointer</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CompareAndSwapPointer</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwapPointer函数执行 unsafe.Pointer 值的比较并交换操作。建议使用更符合人体工程学和更少容易出错的 Pointer.CompareAndSwap。</p>
<h4 id="func-compareandswapuint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol101">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=101" target="_blank" rel="noopener">CompareAndSwapUint32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CompareAndSwapUint32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint32</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwapUint32函数执行 uint32 值的比较并交换操作。建议使用更符合人体工程学和更少容易出错的 Uint32.CompareAndSwap。</p>
<h4 id="func-compareandswapuint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol106">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=106" target="_blank" rel="noopener">CompareAndSwapUint64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CompareAndSwapUint64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint64</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwapUint64函数执行 uint64 值的比较并交换操作。建议使用更符合人体工程学和更少容易出错的 Uint64.CompareAndSwap (特别是针对 32 位平台；参见错误部分)。</p>
<h4 id="func-compareandswapuintptrhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol110">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=110" target="_blank" rel="noopener">CompareAndSwapUintptr</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">CompareAndSwapUintptr</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uintptr</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwapUintptr函数执行 uintptr 值的比较并交换操作。建议使用更符合人体工程学和更少容易出错的 Uintptr.CompareAndSwap。</p>
<h4 id="func-loadint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol144">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=144" target="_blank" rel="noopener">LoadInt32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">LoadInt32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">val</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadInt32函数原子地加载 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Int32.Load。</p>
<h4 id="func-loadint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol149">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=149" target="_blank" rel="noopener">LoadInt64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">LoadInt64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">val</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadInt64函数原子地加载 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Int64.Load(特别是如果您的目标是32位平台；请参见错误部分)。</p>
<h4 id="func-loadpointerhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol166">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=166" target="_blank" rel="noopener">LoadPointer</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">LoadPointer</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>) (<span style="color:#e06c75">val</span> <span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadPointer函数原子地加载 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Pointer.Load。</p>
<h4 id="func-loaduint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol153">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=153" target="_blank" rel="noopener">LoadUint32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">LoadUint32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">val</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadUint32函数原子地加载 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Uint32.Load。</p>
<h4 id="func-loaduint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol158">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=158" target="_blank" rel="noopener">LoadUint64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">LoadUint64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">val</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadUint64函数原子地加载 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Uint64.Load(特别是如果您的目标是32位平台；请参见错误部分)。</p>
<h4 id="func-loaduintptrhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol162">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=162" target="_blank" rel="noopener">LoadUintptr</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">LoadUintptr</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">val</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadUintptr函数原子地加载 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Uintptr.Load。</p>
<h4 id="func-storeint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol170">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=170" target="_blank" rel="noopener">StoreInt32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">StoreInt32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int32</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StoreInt32函数原子地将 val 存储到 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Int32.Store。</p>
<h4 id="func-storeint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol175">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=175" target="_blank" rel="noopener">StoreInt64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">StoreInt64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StoreInt64函数原子地将 val 存储到 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Int64.Store(特别是如果您的目标是32位平台；请参见错误部分)。</p>
<h4 id="func-storepointerhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol192">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=192" target="_blank" rel="noopener">StorePointer</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">StorePointer</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>, <span style="color:#e06c75">val</span> <span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StorePointer函数原子地将 val 存储到 <code>*addr</code>。考虑使用更符合人体工程学且不易出错的 Pointer.Store。</p>
<h4 id="func-storeuint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol179">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=179" target="_blank" rel="noopener">StoreUint32</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">StoreUint32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint32</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StoreUint32函数原子性地将val存储到<code>*addr</code>。考虑使用更符合人体工程学且更少出错的Uint32.Store。</p>
<h4 id="func-storeuint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol184">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=184" target="_blank" rel="noopener">StoreUint64</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">StoreUint64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint64</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StoreUint64函数原子性地将val存储到<code>*addr</code>。考虑使用更符合人体工程学且更少出错的Uint64.Store(特别是针对32位平台，参见bugs一节)。</p>
<h4 id="func-storeuintptrhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol188">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=188" target="_blank" rel="noopener">StoreUintptr</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">StoreUintptr</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uintptr</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	StoreUintptr函数原子性地将val存储到<code>*addr</code>。考虑使用更符合人体工程学且更少出错的Uintptr.Store。</p>
<h4 id="func-swapint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol66----go12">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=66" target="_blank" rel="noopener">SwapInt32</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">SwapInt32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int32</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SwapInt32函数原子性地将new存储到<code>*addr</code>并返回先前的<code>*addr</code>值。考虑使用更符合人体工程学且更少出错的Int32.Swap。</p>
<h4 id="func-swapint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol71----go12">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=71" target="_blank" rel="noopener">SwapInt64</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">SwapInt64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">int64</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SwapInt64函数原子性地将new存储到<code>*addr</code>并返回先前的<code>*addr</code>值。考虑使用更符合人体工程学且更少出错的Int64.Swap(特别是针对32位平台，参见bugs一节)。</p>
<h4 id="func-swappointerhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol88----go12">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=88" target="_blank" rel="noopener">SwapPointer</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">SwapPointer</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>, <span style="color:#e06c75">new</span> <span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>) (<span style="color:#e06c75">old</span> <span style="color:#e06c75">unsafe</span>.<span style="color:#e06c75">Pointer</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SwapPointer函数原子性地将new存储到<code>*addr</code>并返回先前的<code>*addr</code>值。考虑使用更符合人体工程学且更少出错的Pointer.Swap。</p>
<h4 id="func-swapuint32httpscsopensourcegooglegogogo1201srcsyncatomicdocgol75----go12">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=75" target="_blank" rel="noopener">SwapUint32</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">SwapUint32</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint32</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SwapUint32函数原子性地将new存储到<code>*addr</code>并返回先前的<code>*addr</code>值。考虑使用更符合人体工程学且更少出错的Uint32.Swap。</p>
<h4 id="func-swapuint64httpscsopensourcegooglegogogo1201srcsyncatomicdocgol80----go12">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=80" target="_blank" rel="noopener">SwapUint64</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">SwapUint64</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uint64</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SwapUint64函数原子性地将new存储到<code>*addr</code>并返回先前的<code>*addr</code>值。考虑使用更符合人体工程学且更少出错的Uint64.Swap(特别是针对32位平台，参见bugs一节)。</p>
<h4 id="func-swapuintptrhttpscsopensourcegooglegogogo1201srcsyncatomicdocgol84----go12">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/doc.go;l=84" target="_blank" rel="noopener">SwapUintptr</a>  &lt;- go1.2</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">SwapUintptr</span>(<span style="color:#e06c75">addr</span> <span style="color:#56b6c2">*</span><span style="color:#e5c07b">uintptr</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	SwapUintptr函数原子性地将new存储到<code>*addr</code>并返回先前的<code>*addr</code>值。考虑使用更符合人体工程学且更少出错的Uintptr.Swap。</p>
<h2 id="类型">类型</h2>
<h3 id="type-boolhttpscsopensourcegooglegogogo1201srcsyncatomictypegol11----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=11" target="_blank" rel="noopener">Bool</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Bool</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Bool结构体是一个原子布尔值。 零值为false。</p>
<h4 id="bool-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol26----go119">(*Bool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=26" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Bool</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">bool</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法执行布尔值x的比较和交换操作。</p>
<h4 id="bool-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol17----go119">(*Bool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=17" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Bool</span>) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法以原子方式加载并返回存储在x中的值。</p>
<h4 id="bool-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol20----go119">(*Bool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=20" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Bool</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法原子地将val存储到x中。</p>
<h4 id="bool-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol23----go119">(*Bool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=23" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Bool</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e5c07b">bool</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法以原子方式将new存储到x中并返回先前的值。</p>
<h3 id="type-int32httpscsopensourcegooglegogogo1201srcsyncatomictypegol68----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=68" target="_blank" rel="noopener">Int32</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Int32</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Int32方法是一个原子int32。 零值为零。</p>
<h4 id="int32-addhttpscsopensourcegooglegogogo1201srcsyncatomictypegol88----go119">(*Int32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=88" target="_blank" rel="noopener">Add</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int32</span>) <span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#e06c75">delta</span> <span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Add方法原子地将delta添加到x并返回新值。</p>
<h4 id="int32-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol83----go119">(*Int32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=83" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int32</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法执行x的比较和交换操作。</p>
<h4 id="int32-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol74----go119">(*Int32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=74" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int32</span>) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#e5c07b">int32</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法原子地加载并返回存储在x中的值。</p>
<h4 id="int32-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol77----go119">(*Int32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=77" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int32</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法原子地将val存储到x中。</p>
<h4 id="int32-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol80----go119">(*Int32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=80" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int32</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e5c07b">int32</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">int32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法原子地将new存储到x中并返回先前的值。</p>
<h3 id="type-int64httpscsopensourcegooglegogogo1201srcsyncatomictypegol91----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=91" target="_blank" rel="noopener">Int64</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Int64</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Int64方法是原子int64。零值为零。</p>
<h4 id="int64-addhttpscsopensourcegooglegogogo1201srcsyncatomictypegol112----go119">(*Int64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=112" target="_blank" rel="noopener">Add</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int64</span>) <span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#e06c75">delta</span> <span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Add方法原子地将delta添加到x并返回新值。</p>
<h4 id="int64-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol107----go119">(*Int64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=107" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int64</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法执行x的比较并交换操作。</p>
<h4 id="int64-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol98----go119">(*Int64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=98" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int64</span>) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#e5c07b">int64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法原子地加载并返回存储在x中的值。</p>
<h4 id="int64-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol101----go119">(*Int64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=101" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int64</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法原子地将val存储到x中。</p>
<h4 id="int64-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol104----go119">(*Int64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=104" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Int64</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e5c07b">int64</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">int64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法原子地将new存储到x中并返回先前的值。</p>
<h3 id="type-pointerhttpscsopensourcegooglegogogo1201srcsyncatomictypegol43----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=43" target="_blank" rel="noopener">Pointer</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Pointer</span>[<span style="color:#e06c75">T</span> <span style="color:#e06c75">any</span>] <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Pointer 是一个类型为 *T 的原子指针。零值是 nil 的 *T。</p>
<h4 id="pointert-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol63----go119">(*Pointer[T]) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=63" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Pointer</span>[<span style="color:#e06c75">T</span>]) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">T</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法执行 x 的比较并交换操作。</p>
<h4 id="pointert-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol54----go119">(*Pointer[T]) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=54" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Pointer</span>[<span style="color:#e06c75">T</span>]) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#56b6c2">*</span><span style="color:#e06c75">T</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法原子地加载并返回存储在 x 中的值。</p>
<h4 id="pointert-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol57----go119">(*Pointer[T]) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=57" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Pointer</span>[<span style="color:#e06c75">T</span>]) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">T</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法原子地将 val 存储到 x 中。</p>
<h4 id="pointert-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol60----go119">(*Pointer[T]) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=60" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Pointer</span>[<span style="color:#e06c75">T</span>]) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">T</span>) (<span style="color:#e06c75">old</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">T</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法原子地将 new 存储到 x 中，并返回先前的值。</p>
<h3 id="type-uint32httpscsopensourcegooglegogogo1201srcsyncatomictypegol115----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=115" target="_blank" rel="noopener">Uint32</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Uint32</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Uint32方法是一个原子 uint32。零值是零。</p>
<h4 id="uint32-addhttpscsopensourcegooglegogogo1201srcsyncatomictypegol135----go119">(*Uint32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=135" target="_blank" rel="noopener">Add</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint32</span>) <span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#e06c75">delta</span> <span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Add方法原子地将 delta 添加到 x 并返回新值。</p>
<h4 id="uint32-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol130----go119">(*Uint32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=130" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint32</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法执行 x 的比较并交换操作。</p>
<h4 id="uint32-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol121----go119">(*Uint32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=121" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint32</span>) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#e5c07b">uint32</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法原子地加载并返回存储在x中的值。</p>
<h4 id="uint32-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol124----go119">(*Uint32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=124" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint32</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法原子地将val存储到x中。</p>
<h4 id="uint32-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol127----go119">(*Uint32) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=127" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint32</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint32</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">uint32</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法原子地将new存储到x中并返回先前的值。</p>
<h3 id="type-uint64httpscsopensourcegooglegogogo1201srcsyncatomictypegol138----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=138" target="_blank" rel="noopener">Uint64</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Uint64</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Uint64方法是一个原子性的uint64类型。零值为零。</p>
<h4 id="uint64-addhttpscsopensourcegooglegogogo1201srcsyncatomictypegol159----go119">(*Uint64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=159" target="_blank" rel="noopener">Add</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint64</span>) <span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#e06c75">delta</span> <span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Add方法原子性地将delta添加到x中并返回新值。</p>
<h4 id="uint64-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol154----go119">(*Uint64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=154" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint64</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法在x上执行比较并交换操作。</p>
<h4 id="uint64-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol145----go119">(*Uint64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=145" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint64</span>) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#e5c07b">uint64</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法原子地加载并返回存储在x中的值。</p>
<h4 id="uint64-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol148----go119">(*Uint64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=148" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint64</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法原子地将val存储到x中。</p>
<h4 id="uint64-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol151----go119">(*Uint64) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=151" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uint64</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uint64</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">uint64</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法原子地将new存储到x中并返回先前的值。</p>
<h3 id="type-uintptrhttpscsopensourcegooglegogogo1201srcsyncatomictypegol162----go119">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=162" target="_blank" rel="noopener">Uintptr</a>  &lt;- go1.19</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Uintptr</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Uintptr是一个原子的uintptr类型。零值为零。</p>
<h4 id="uintptr-addhttpscsopensourcegooglegogogo1201srcsyncatomictypegol182----go119">(*Uintptr) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=182" target="_blank" rel="noopener">Add</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uintptr</span>) <span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#e06c75">delta</span> <span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Add方法原子地将delta添加到x并返回新值。</p>
<h4 id="uintptr-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol177----go119">(*Uintptr) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=177" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uintptr</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法执行x的比较和交换操作。</p>
<h4 id="uintptr-loadhttpscsopensourcegooglegogogo1201srcsyncatomictypegol168----go119">(*Uintptr) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=168" target="_blank" rel="noopener">Load</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uintptr</span>) <span style="color:#61afef;font-weight:bold">Load</span>() <span style="color:#e5c07b">uintptr</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法以原子方式加载并返回存储在x中的值。</p>
<h4 id="uintptr-storehttpscsopensourcegooglegogogo1201srcsyncatomictypegol171----go119">(*Uintptr) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=171" target="_blank" rel="noopener">Store</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uintptr</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法以原子方式将val存储到x中。</p>
<h4 id="uintptr-swaphttpscsopensourcegooglegogogo1201srcsyncatomictypegol174----go119">(*Uintptr) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/type.go;l=174" target="_blank" rel="noopener">Swap</a>  &lt;- go1.19</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">x</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Uintptr</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e5c07b">uintptr</span>) (<span style="color:#e06c75">old</span> <span style="color:#e5c07b">uintptr</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法以原子方式将new存储到x中并返回先前的值。</p>
<h3 id="type-valuehttpscsopensourcegooglegogogo1201srcsyncatomicvaluegol16----go14">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/value.go;l=16" target="_blank" rel="noopener">Value</a>  &lt;- go1.4</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Value</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Value类型提供了一个一致类型值的原子加载和存储。Value类型的零值从Load返回nil。一旦调用了Store，就不能再复制Value。</p>
<p>​	使用后不能再复制Value。</p>
<h5 id="example-config">Example (Config)</h5>
<p>The following example shows how to use Value for periodic program config updates and propagation of the changes to worker goroutines.</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;sync/atomic&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">loadConfig</span>() <span style="color:#c678dd">map</span>[<span style="color:#e5c07b">string</span>]<span style="color:#e5c07b">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> <span style="color:#e5c07b">make</span>(<span style="color:#c678dd">map</span>[<span style="color:#e5c07b">string</span>]<span style="color:#e5c07b">string</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">requests</span>() <span style="color:#c678dd">chan</span> <span style="color:#e5c07b">int</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> <span style="color:#e5c07b">make</span>(<span style="color:#c678dd">chan</span> <span style="color:#e5c07b">int</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">config</span> <span style="color:#e06c75">atomic</span>.<span style="color:#e06c75">Value</span> <span style="color:#7f848e">// holds current server configuration
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// Create initial config value and store into config.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">config</span>.<span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#61afef;font-weight:bold">loadConfig</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">go</span> <span style="color:#c678dd">func</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// Reload config every 10 seconds
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// and update config value with the new version.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">for</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">time</span>.<span style="color:#61afef;font-weight:bold">Sleep</span>(<span style="color:#d19a66">10</span> <span style="color:#56b6c2">*</span> <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Second</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">config</span>.<span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#61afef;font-weight:bold">loadConfig</span>())
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}()
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Create worker goroutines that handle incoming requests
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// using the latest config value.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">0</span>; <span style="color:#e06c75">i</span> &lt; <span style="color:#d19a66">10</span>; <span style="color:#e06c75">i</span><span style="color:#56b6c2">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">go</span> <span style="color:#c678dd">func</span>() {
</span></span><span style="display:flex;"><span>			<span style="color:#c678dd">for</span> <span style="color:#e06c75">r</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">range</span> <span style="color:#61afef;font-weight:bold">requests</span>() {
</span></span><span style="display:flex;"><span>				<span style="color:#e06c75">c</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">config</span>.<span style="color:#61afef;font-weight:bold">Load</span>()
</span></span><span style="display:flex;"><span>				<span style="color:#7f848e">// Handle request r using config c.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>				<span style="color:#e06c75">_</span>, <span style="color:#e06c75">_</span> = <span style="color:#e06c75">r</span>, <span style="color:#e06c75">c</span>
</span></span><span style="display:flex;"><span>			}
</span></span><span style="display:flex;"><span>		}()
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="example-readmostly">Example (ReadMostly)</h5>
<p>The following example shows how to maintain a scalable frequently read, but infrequently updated data structure using copy-on-write idiom.</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;sync/atomic&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">type</span> <span style="color:#e06c75">Map</span> <span style="color:#c678dd">map</span>[<span style="color:#e5c07b">string</span>]<span style="color:#e5c07b">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">m</span> <span style="color:#e06c75">atomic</span>.<span style="color:#e06c75">Value</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">m</span>.<span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e5c07b">make</span>(<span style="color:#e06c75">Map</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">mu</span> <span style="color:#e06c75">sync</span>.<span style="color:#e06c75">Mutex</span> <span style="color:#7f848e">// used only by writers
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// read function can be used to read the data without further synchronization
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">read</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">func</span>(<span style="color:#e06c75">key</span> <span style="color:#e5c07b">string</span>) (<span style="color:#e06c75">val</span> <span style="color:#e5c07b">string</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">m1</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">m</span>.<span style="color:#61afef;font-weight:bold">Load</span>().(<span style="color:#e06c75">Map</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">return</span> <span style="color:#e06c75">m1</span>[<span style="color:#e06c75">key</span>]
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// insert function can be used to update the data without further synchronization
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">insert</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">func</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">string</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">mu</span>.<span style="color:#61afef;font-weight:bold">Lock</span>() <span style="color:#7f848e">// synchronize with other potential writers
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">defer</span> <span style="color:#e06c75">mu</span>.<span style="color:#61afef;font-weight:bold">Unlock</span>()
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">m1</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">m</span>.<span style="color:#61afef;font-weight:bold">Load</span>().(<span style="color:#e06c75">Map</span>) <span style="color:#7f848e">// load current value of the data structure
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">m2</span> <span style="color:#56b6c2">:=</span> <span style="color:#e5c07b">make</span>(<span style="color:#e06c75">Map</span>)      <span style="color:#7f848e">// create a new value
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">for</span> <span style="color:#e06c75">k</span>, <span style="color:#e06c75">v</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">range</span> <span style="color:#e06c75">m1</span> {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">m2</span>[<span style="color:#e06c75">k</span>] = <span style="color:#e06c75">v</span> <span style="color:#7f848e">// copy all data from the current object to the new one
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		}
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">m2</span>[<span style="color:#e06c75">key</span>] = <span style="color:#e06c75">val</span> <span style="color:#7f848e">// do the update that we need
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">m</span>.<span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">m2</span>)   <span style="color:#7f848e">// atomically replace the current object with the new one
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// At this point all new readers start working with the new version.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// The old version will be garbage collected once the existing readers
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// (if any) are done with it.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">_</span>, <span style="color:#e06c75">_</span> = <span style="color:#e06c75">read</span>, <span style="color:#e06c75">insert</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="value-compareandswaphttpscsopensourcegooglegogogo1201srcsyncatomicvaluegol135----go117">(*Value) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/value.go;l=135" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.17</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">v</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Value</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">swapped</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>CompareAndSwap方法为Value执行比较和交换操作。</p>
<p>​	所有对给定Value的CompareAndSwap调用必须使用相同具体类型的值。类型不一致的CompareAndSwap会导致panic，CompareAndSwap(old, nil)也是如此。</p>
<h4 id="value-loadhttpscsopensourcegooglegogogo1201srcsyncatomicvaluegol28----go14">(*Value) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/value.go;l=28" target="_blank" rel="noopener">Load</a>  &lt;- go1.4</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">v</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Value</span>) <span style="color:#61afef;font-weight:bold">Load</span>() (<span style="color:#e06c75">val</span> <span style="color:#e06c75">any</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法返回最近一次Store设置的值。如果没有为此Value调用Store，则返回nil。</p>
<h4 id="value-storehttpscsopensourcegooglegogogo1201srcsyncatomicvaluegol47----go14">(*Value) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/value.go;l=47" target="_blank" rel="noopener">Store</a>  &lt;- go1.4</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">v</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Value</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">val</span> <span style="color:#e06c75">any</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法将Value v的值设置为val。所有对给定Value的Store调用必须使用相同具体类型的值。类型不一致的Store会导致panic，Store(nil)也是如此。</p>
<h4 id="value-swaphttpscsopensourcegooglegogogo1201srcsyncatomicvaluegol90----go117">(*Value) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/atomic/value.go;l=90" target="_blank" rel="noopener">Swap</a>  &lt;- go1.17</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">v</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Value</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">new</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">old</span> <span style="color:#e06c75">any</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法操作将new值存储到Value中，并返回旧值。如果Value为空，则返回nil。</p>
<p>​	对于同一个 Value，所有 Swap方法的调用必须使用相同的具体类型的值。如果使用不一致的类型进行 Swap方法，会导致 panic，就像 Swap(nil) 一样。</p>
<h2 id="notes">Notes</h2>
<h2 id="bugs">Bugs</h2>
<ul>
<li>
<p>在386上，64位函数使用Pentium MMX之前不可用的指令。</p>
<p>在非Linux ARM上，64位函数使用ARMv6k核心之前不可用的指令。</p>
<p>在ARM，386和32位MIPS上，通过原子函数访问64位字(类型Int64和Uint64自动对齐)的调用方有责任安排64位对齐。可以依靠分配的结构体，数组或切片中的第一个字，全局变量中的第一个字或局部变量中的第一个字(因为所有原子操作的主题都将逃逸到堆中)为64位对齐。</p>
</li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-139625d088b601d2bcbb250c511c8f8b">2 - sync</h1>
    
	<h1 id="sync">sync</h1>
<p><a href="https://pkg.go.dev/sync@go1.20.1" target="_blank" rel="noopener">https://pkg.go.dev/sync@go1.20.1</a></p>
<p>​	 sync包提供了基本的同步原语，如互斥锁。除了 Once 和 WaitGroup 类型外，大多数都是用于低级库例程的。更高级别的同步最好通过通道和通信实现。</p>
<p>Values containing the types defined in this package should not be copied.</p>
<p>​	包含此包中定义的类型的值不应被复制。</p>
<h2 id="常量">常量</h2>
<p>This section is empty.</p>
<h2 id="变量">变量</h2>
<p>This section is empty.</p>
<h2 id="函数">函数</h2>
<p>This section is empty.</p>
<h2 id="类型">类型</h2>
<h3 id="type-condhttpscsopensourcegooglegogogo1201srcsynccondgol36">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/cond.go;l=36" target="_blank" rel="noopener">Cond</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Cond</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 在观察或更改条件时保持 L
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">L</span> <span style="color:#e06c75">Locker</span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// 包含过滤或未公开的字段
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Cond结构体实现条件变量，是用于等待或宣布事件发生的 goroutine 等待的交汇点。</p>
<p>​	每个 Cond 都有一个关联的 Locker L(通常是 <code>*Mutex</code> 或 <code>*RWMutex</code>)，在更改条件和调用 Wait 方法时必须持有该锁。</p>
<p>​	Cond 在首次使用后不得复制。</p>
<p>​	Cond 在 Go 内存模型的术语中，使 Broadcast 或 Signal 调用在解除其阻塞的任何 Wait 调用&quot;之前同步&quot;。</p>
<p>​	对于许多简单的用例，用户最好使用通道而不是 Cond(Broadcast 对应于关闭通道，而 Signal 对应于在通道上发送)。</p>
<p>​	有关替代 sync.Cond 的更多信息，请参见 <a href="https://blogtitle.github.io/categories/concurrency/" target="_blank" rel="noopener">Roberto Clapis 的高级并发模式系列</a>以及 <a href="https://drive.google.com/file/d/1nPdvhB0PutEJzdCq5ms6UI58dp50fcAN/view" target="_blank" rel="noopener">Bryan Mills 的并发模式演讲</a>。</p>
<h4 id="func-newcondhttpscsopensourcegooglegogogo1201srcsynccondgol47">func <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/cond.go;l=47" target="_blank" rel="noopener">NewCond</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">NewCond</span>(<span style="color:#e06c75">l</span> <span style="color:#e06c75">Locker</span>) <span style="color:#56b6c2">*</span><span style="color:#e06c75">Cond</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	NewCond函数返回一个带有 Locker l 的新 Cond。</p>
<h4 id="cond-broadcasthttpscsopensourcegooglegogogo1201srcsynccondgol90">(*Cond) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/cond.go;l=90" target="_blank" rel="noopener">Broadcast</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Cond</span>) <span style="color:#61afef;font-weight:bold">Broadcast</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Broadcast方法唤醒正在c上等待的所有goroutine。</p>
<p>​	调用者可以在调用时持有c.L，但不是必须的。</p>
<h4 id="cond-signalhttpscsopensourcegooglegogogo1201srcsynccondgol81">(*Cond) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/cond.go;l=81" target="_blank" rel="noopener">Signal</a></h4>
<pre tabindex="0"><code>func (c *Cond) Signal()
</code></pre><p>​	Signal 方法会唤醒一个等待在 c 上的 goroutine，如果有的话。</p>
<p>​	调用 Signal 时，允许但不要求调用方持有 c.L。</p>
<p>​	Signal() 不会影响 goroutine 的调度优先级；如果其他 goroutine 正在尝试锁定 c.L，则它们可能会在&quot;等待(waiting)&ldquo;goroutine之前被唤醒。</p>
<h4 id="cond-waithttpscsopensourcegooglegogogo1201srcsynccondgol66">(*Cond) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/cond.go;l=66" target="_blank" rel="noopener">Wait</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">c</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Cond</span>) <span style="color:#61afef;font-weight:bold">Wait</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Wait方法原子性地解锁 c.L 并挂起调用的 goroutine 的执行。稍后恢复执行后，Wait 在返回之前锁定 c.L。与其他系统不同，除非被 Broadcast 或 Signal 唤醒，Wait 不能返回。</p>
<p>​	由于 Wait方法在等待时未锁定 c.L，因此调用者通常不能假设在 Wait 返回时条件为真。相反，调用者应在循环中等待：</p>
<pre tabindex="0"><code>c.L.Lock()
for !condition() {
    c.Wait()
}
... make use of condition ...
c.L.Unlock()
</code></pre><h3 id="type-lockerhttpscsopensourcegooglegogogo1201srcsyncmutexgol40">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/mutex.go;l=40" target="_blank" rel="noopener">Locker</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Locker</span> <span style="color:#c678dd">interface</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Lock</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Unlock</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Locker接口表示一个可以锁定和解锁的对象。</p>
<h3 id="type-maphttpscsopensourcegooglegogogo1201srcsyncmapgol35----go19">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=35" target="_blank" rel="noopener">Map</a>  &lt;- go1.9</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Map</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Map结构体类似于 Go map[interface{}]interface{}，但可以在多个 goroutine 中安全地使用，而无需额外的锁定或协调。负载、存储和删除以平摊常数时间运行。</p>
<p>​	Map类型是特定的。大多数代码应该使用普通的Go map，通过单独的锁或协调来实现更好的类型安全性，并使其更容易维护map内容的其他不变量。</p>
<p>​	Map类型针对两种常见用例进行了优化：(1) 给定键的条目仅被写入一次，但被多次读取，例如仅增长的缓存；或者(2) 多个goroutine读取、写入和覆盖不重叠的键集的条目。在这两种情况下，与配对单独的Mutex或RWMutex的Go map相比，使用Map可能会显著降低锁争用。</p>
<p>​	零值Map为空且可以直接使用。Map在第一次使用后不得复制。</p>
<p>​	根据Go内存模型的术语，Map安排写操作&quot;在&quot;观察到写操作的效果的任何读取操作&quot;之前&rdquo;，其中读取和写操作定义如下。Load，LoadAndDelete，LoadOrStore，Swap，CompareAndSwap和CompareAndDelete是读取操作; Delete，LoadAndDelete，Store和Swap是写操作;当LoadOrStore返回loaded设置为false时，它是一个写操作;当CompareAndSwap返回swapped设置为true时，它是一个写操作;当CompareAndDelete返回deleted设置为true时，它是一个写操作。</p>
<h4 id="map-compareanddeletehttpscsopensourcegooglegogogo1201srcsyncmapgol406----go120">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=406" target="_blank" rel="noopener">CompareAndDelete</a>  &lt;- go1.20</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">CompareAndDelete</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">old</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">deleted</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndDelete方法会删除键为key的条目，如果它的值等于old。旧值必须是可比较类型。</p>
<p>​	如果map中没有当前键的值，则CompareAndDelete方法返回false(即使旧值是nil接口值)。</p>
<h4 id="map-compareandswaphttpscsopensourcegooglegogogo1201srcsyncmapgol374----go120">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=374" target="_blank" rel="noopener">CompareAndSwap</a>  &lt;- go1.20</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">CompareAndSwap</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">old</span>, <span style="color:#e06c75">new</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	CompareAndSwap方法会交换键的旧值和新值，如果存储在map中的值等于旧值。旧值必须是可比较类型。</p>
<h4 id="map-deletehttpscsopensourcegooglegogogo1201srcsyncmapgol296----go19">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=296" target="_blank" rel="noopener">Delete</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">Delete</span>(<span style="color:#e06c75">key</span> <span style="color:#e06c75">any</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Delete方法用于删除一个键的值。</p>
<h4 id="map-loadhttpscsopensourcegooglegogogo1201srcsyncmapgol120----go19">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=120" target="_blank" rel="noopener">Load</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">Load</span>(<span style="color:#e06c75">key</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>, <span style="color:#e06c75">ok</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Load方法用于获取一个键对应的值。如果键不存在，返回值value为nil，ok为false。</p>
<h4 id="map-loadanddeletehttpscsopensourcegooglegogogo1201srcsyncmapgol272----go115">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=272" target="_blank" rel="noopener">LoadAndDelete</a>  &lt;- go1.15</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">LoadAndDelete</span>(<span style="color:#e06c75">key</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>, <span style="color:#e06c75">loaded</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadAndDelete方法用于获取一个键对应的值并从Map中删除该键值对。如果键不存在，则返回值value为nil，loaded为false。</p>
<h4 id="map-loadorstorehttpscsopensourcegooglegogogo1201srcsyncmapgol203----go19">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=203" target="_blank" rel="noopener">LoadOrStore</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">LoadOrStore</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">actual</span> <span style="color:#e06c75">any</span>, <span style="color:#e06c75">loaded</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	LoadOrStore方法用于获取一个键对应的值。如果键存在，返回值actual为已存在的值，loaded为true。如果键不存在，会将给定的值存储并返回，此时loaded为false。</p>
<h4 id="map-rangehttpscsopensourcegooglegogogo1201srcsyncmapgol449----go19">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=449" target="_blank" rel="noopener">Range</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">Range</span>(<span style="color:#e06c75">f</span> <span style="color:#c678dd">func</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Range方法遍历Map中的每个键值对，并按顺序调用参数f。如果f返回false，则停止迭代。</p>
<p>​	Range方法并不一定对应Map内容的一致快照。如果在Range调用期间并发地存储或删除任何键的值(包括在f中)，则Range可能会反映该键的任何时点的任何映射。Range方法不会阻塞接收器上的其他方法；即使f本身也可以调用m上的任何方法。</p>
<p>​	即使f返回false，Range方法的时间复杂度可能为O(N)，其中N为Map中元素的数量。</p>
<h4 id="map-storehttpscsopensourcegooglegogogo1201srcsyncmapgol154----go19">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=154" target="_blank" rel="noopener">Store</a>  &lt;- go1.9</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">Store</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Store方法用于设置一个键的值。</p>
<h4 id="map-swaphttpscsopensourcegooglegogogo1201srcsyncmapgol330----go120">(*Map) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/map.go;l=330" target="_blank" rel="noopener">Swap</a>  &lt;- go1.20</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Map</span>) <span style="color:#61afef;font-weight:bold">Swap</span>(<span style="color:#e06c75">key</span>, <span style="color:#e06c75">value</span> <span style="color:#e06c75">any</span>) (<span style="color:#e06c75">previous</span> <span style="color:#e06c75">any</span>, <span style="color:#e06c75">loaded</span> <span style="color:#e5c07b">bool</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Swap方法交换给定键的值并返回先前的值(如果存在)。loaded结果报告键是否存在。</p>
<h3 id="type-mutexhttpscsopensourcegooglegogogo1201srcsyncmutexgol34">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/mutex.go;l=34" target="_blank" rel="noopener">Mutex</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Mutex</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Mutex类型是互斥锁。互斥锁的零值是未锁定的互斥锁。</p>
<p>​	Mutex在第一次使用后不能被复制。</p>
<p>​	根据Go内存模型的术语，第n次Unlock调用&quot;在&quot; m次调用Lock之前同步，其中n &lt; m。成功调用TryLock等效于调用Lock。TryLock的失败调用根本不建立任何&quot;在之前同步&quot;的关系。</p>
<h4 id="mutex-lockhttpscsopensourcegooglegogogo1201srcsyncmutexgol81">(*Mutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/mutex.go;l=81" target="_blank" rel="noopener">Lock</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Mutex</span>) <span style="color:#61afef;font-weight:bold">Lock</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Lock方法锁定m。如果锁已经在使用中，则调用goroutine会阻塞，直到互斥锁可用。</p>
<h4 id="mutex-trylockhttpscsopensourcegooglegogogo1201srcsyncmutexgol98----go118">(*Mutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/mutex.go;l=98" target="_blank" rel="noopener">TryLock</a>  &lt;- go1.18</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Mutex</span>) <span style="color:#61afef;font-weight:bold">TryLock</span>() <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	TryLock方法尝试锁定m并报告是否成功。</p>
<p>​	请注意，尽管存在正确使用TryLock方法，但它们很少出现，并且使用TryLock方法通常是特定互斥锁使用中更深层次问题的标志。</p>
<h4 id="mutex-unlockhttpscsopensourcegooglegogogo1201srcsyncmutexgol212">(*Mutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/mutex.go;l=212" target="_blank" rel="noopener">Unlock</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">m</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Mutex</span>) <span style="color:#61afef;font-weight:bold">Unlock</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Unlock解锁m。如果在进入Unlock时未锁定m，则会引发运行时错误。</p>
<p>​	锁定的互斥锁与特定goroutine不相关联。允许一个goroutine锁定Mutex，然后安排另一个goroutine解锁它。</p>
<h3 id="type-oncehttpscsopensourcegooglegogogo1201srcsynconcegol18">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/once.go;l=18" target="_blank" rel="noopener">Once</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Once</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Once 对象只会执行一次操作。</p>
<p>​	在第一次使用后，Once 不能被复制。</p>
<p>​	在 Go 内存模型的术语中，f 函数的返回值在 any 调用 once.Do(f) 的返回值之前&quot;同步&quot;。</p>
<h5 id="example">Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">once</span> <span style="color:#e06c75">sync</span>.<span style="color:#e06c75">Once</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">onceBody</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">func</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#e06c75">fmt</span>.<span style="color:#61afef;font-weight:bold">Println</span>(<span style="color:#98c379">&#34;Only once&#34;</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">done</span> <span style="color:#56b6c2">:=</span> <span style="color:#e5c07b">make</span>(<span style="color:#c678dd">chan</span> <span style="color:#e5c07b">bool</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">0</span>; <span style="color:#e06c75">i</span> &lt; <span style="color:#d19a66">10</span>; <span style="color:#e06c75">i</span><span style="color:#56b6c2">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#c678dd">go</span> <span style="color:#c678dd">func</span>() {
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">once</span>.<span style="color:#61afef;font-weight:bold">Do</span>(<span style="color:#e06c75">onceBody</span>)
</span></span><span style="display:flex;"><span>			<span style="color:#e06c75">done</span> <span style="color:#56b6c2">&lt;-</span> <span style="color:#e5c07b">true</span>
</span></span><span style="display:flex;"><span>		}()
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">i</span> <span style="color:#56b6c2">:=</span> <span style="color:#d19a66">0</span>; <span style="color:#e06c75">i</span> &lt; <span style="color:#d19a66">10</span>; <span style="color:#e06c75">i</span><span style="color:#56b6c2">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#56b6c2">&lt;-</span><span style="color:#e06c75">done</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Output</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Only</span> <span style="color:#e06c75">once</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="once-dohttpscsopensourcegooglegogogo1201srcsynconcegol48">(*Once) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/once.go;l=48" target="_blank" rel="noopener">Do</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">o</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Once</span>) <span style="color:#61afef;font-weight:bold">Do</span>(<span style="color:#e06c75">f</span> <span style="color:#c678dd">func</span>())
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Do方法只在第一次针对该 Once 实例调用 Do 时调用函数 f。换句话说，给定</p>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">once</span> <span style="color:#e06c75">Once</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	如果多次调用 once.Do(f)，则仅有第一次调用会调用 f，即使 f 在每次调用中的值不同，也是如此。对于每个需要执行的函数，都需要一个新的 Once 实例。</p>
<p>​	Do方法旨在进行必须仅运行一次的初始化。由于 f 是零参函数，可能需要使用函数文本来捕获由 Do 调用的函数的参数：</p>
<pre tabindex="0"><code>config.once.Do(func() { config.init(filename) })
</code></pre><p>​	因为在 f 返回之前，没有 Do方法调用会返回，所以如果 f 调用 Do，它将死锁。</p>
<p>​	如果 f 引发 panic，Do方法将视其为已返回；将来的 Do方法调用将在不调用 f 的情况下返回。</p>
<h3 id="type-poolhttpscsopensourcegooglegogogo1201srcsyncpoolgol49----go13">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/pool.go;l=49" target="_blank" rel="noopener">Pool</a>  &lt;- go1.3</h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">Pool</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// New optionally specifies a function to generate
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// a value when Get would otherwise return nil.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#7f848e">// It may not be changed concurrently with calls to Get.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">New</span> <span style="color:#c678dd">func</span>() <span style="color:#e06c75">any</span>
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	类型 Pool 是一组可临时保存和检索的对象。</p>
<p>​	在任何时候，存储在 Pool 中的任何项都可能被自动删除而没有通知。如果在此时 Pool 持有唯一的引用，则可能会被解除分配。</p>
<p>​	Pool 可以同时安全地用于多个 goroutine。</p>
<p>​	Pool 的目的是缓存已分配但未使用的项目以供以后重用，从而减轻垃圾回收器的压力。也就是说，它使得构建高效、线程安全的自由列表变得容易。但是，它不适用于所有自由列表。</p>
<p>​	Pool 的一个合适的用途是管理一组在包的并发独立客户端之间隐式共享的临时项目，并且这些项目可能会被重用。Pool 提供了一种将分配开销分摊到许多客户端的方式。</p>
<p>​	fmt 包是 Pool 的一个很好的用例，它维护一个动态大小的临时输出缓冲区存储。当许多 goroutine 正在积极打印时，存储会扩展，而在空闲时会缩小。</p>
<p>​	另一方面，作为短暂对象的一部分维护的自由列表不适合用于 Pool，因为在这种情况下，开销无法很好地分摊。在这种情况下，让这些对象实现自己的自由列表更有效率。</p>
<p>​	Pool 在第一次使用后不得进行复制。</p>
<p>​	在 Go 内存模型的术语中，Put(x) 的调用&quot;在&quot; Get 返回同一值 x 之前同步。同样，New 返回 x 的调用&quot;在&quot; Get 返回同一值 x 之前同步。</p>
<h5 id="example-1">Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">43
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;bytes&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;io&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">bufPool</span> = <span style="color:#e06c75">sync</span>.<span style="color:#e06c75">Pool</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">New</span>: <span style="color:#c678dd">func</span>() <span style="color:#e06c75">any</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// The Pool&#39;s New function should generally only return pointer
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// types, since a pointer can be put into the return interface
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#7f848e">// value without an allocation:
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">return</span> <span style="color:#e5c07b">new</span>(<span style="color:#e06c75">bytes</span>.<span style="color:#e06c75">Buffer</span>)
</span></span><span style="display:flex;"><span>	},
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e">// timeNow is a fake version of time.Now for tests.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">timeNow</span>() <span style="color:#e06c75">time</span>.<span style="color:#e06c75">Time</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">return</span> <span style="color:#e06c75">time</span>.<span style="color:#61afef;font-weight:bold">Unix</span>(<span style="color:#d19a66">1136214245</span>, <span style="color:#d19a66">0</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">Log</span>(<span style="color:#e06c75">w</span> <span style="color:#e06c75">io</span>.<span style="color:#e06c75">Writer</span>, <span style="color:#e06c75">key</span>, <span style="color:#e06c75">val</span> <span style="color:#e5c07b">string</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">b</span> <span style="color:#56b6c2">:=</span> <span style="color:#e06c75">bufPool</span>.<span style="color:#61afef;font-weight:bold">Get</span>().(<span style="color:#56b6c2">*</span><span style="color:#e06c75">bytes</span>.<span style="color:#e06c75">Buffer</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">Reset</span>()
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Replace this with time.Now() in a real logger.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">WriteString</span>(<span style="color:#61afef;font-weight:bold">timeNow</span>().<span style="color:#61afef;font-weight:bold">UTC</span>().<span style="color:#61afef;font-weight:bold">Format</span>(<span style="color:#e06c75">time</span>.<span style="color:#e06c75">RFC3339</span>))
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">WriteByte</span>(<span style="color:#98c379">&#39; &#39;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">WriteString</span>(<span style="color:#e06c75">key</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">WriteByte</span>(<span style="color:#98c379">&#39;=&#39;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">WriteString</span>(<span style="color:#e06c75">val</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">w</span>.<span style="color:#61afef;font-weight:bold">Write</span>(<span style="color:#e06c75">b</span>.<span style="color:#61afef;font-weight:bold">Bytes</span>())
</span></span><span style="display:flex;"><span>	<span style="color:#e06c75">bufPool</span>.<span style="color:#61afef;font-weight:bold">Put</span>(<span style="color:#e06c75">b</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#61afef;font-weight:bold">Log</span>(<span style="color:#e06c75">os</span>.<span style="color:#e06c75">Stdout</span>, <span style="color:#98c379">&#34;path&#34;</span>, <span style="color:#98c379">&#34;/search?q=flowers&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Output</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#d19a66">2006</span><span style="color:#56b6c2">-</span><span style="color:#d19a66">01</span><span style="color:#56b6c2">-</span><span style="color:#d19a66">02</span><span style="color:#e06c75">T15</span>:<span style="color:#d19a66">04</span>:<span style="color:#d19a66">05</span><span style="color:#e06c75">Z</span> <span style="color:#e06c75">path</span>=<span style="color:#56b6c2">/</span><span style="color:#e06c75">search</span>?<span style="color:#e06c75">q</span>=<span style="color:#e06c75">flowers</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="pool-gethttpscsopensourcegooglegogogo1201srcsyncpoolgol127----go13">(*Pool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/pool.go;l=127" target="_blank" rel="noopener">Get</a>  &lt;- go1.3</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">p</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Pool</span>) <span style="color:#61afef;font-weight:bold">Get</span>() <span style="color:#e06c75">any</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Get 方法从池中选择一个任意项、将其从池中移除并返回给调用者。Get 可能会选择忽略池并将其视为空。调用者不应假设 Put 传递的值与 Get 返回的值之间有任何关系。</p>
<p>​	如果 Get方法原本会返回 nil，且 p.New 不为 nil，则 Get 返回调用 p.New 的结果。</p>
<h4 id="pool-puthttpscsopensourcegooglegogogo1201srcsyncpoolgol95----go13">(*Pool) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/pool.go;l=95" target="_blank" rel="noopener">Put</a>  &lt;- go1.3</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">p</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">Pool</span>) <span style="color:#61afef;font-weight:bold">Put</span>(<span style="color:#e06c75">x</span> <span style="color:#e06c75">any</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Put 方法将 x 添加到池中。</p>
<h3 id="type-rwmutexhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol36">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=36" target="_blank" rel="noopener">RWMutex</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">RWMutex</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RWMutex 是一个读写互斥锁。锁可以被任意数量的读取器或单个写入器持有。RWMutex 的零值为未锁定的互斥锁。</p>
<p>​	RWMutex 必须在第一次使用后不进行复制。</p>
<p>​	如果一个 goroutine 持有 RWMutex 进行读取，并且另一个 goroutine 可能调用 Lock，则没有 goroutine 应该期望能够在初始读取锁定被释放之前获取读取锁定。特别地，这禁止了递归读取锁定。这是为了确保锁最终变为可用；一个被阻塞的 Lock 调用排除了新的读取器获取锁定。</p>
<p>​	按照 Go 内存模型的术语，第 n 次调用 Unlock &ldquo;在之前同步&quot;第 m 次调用 Lock，就像 Mutex 一样。对于任何对 RLock 的调用，都存在一个 n，使得第 n 次调用 Unlock &ldquo;在之前同步&quot;该对 RLock 的调用，而相应的 RUnlock 调用&quot;在之前同步&quot;第 n+1 次调用 Lock。</p>
<h4 id="rwmutex-lockhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol141">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=141" target="_blank" rel="noopener">Lock</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">Lock</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Lock方法锁定 rw 进行写入。如果锁已被锁定以供读取或写入，则 Lock 阻塞，直到锁可用。</p>
<h4 id="rwmutex-rlockhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol64">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=64" target="_blank" rel="noopener">RLock</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">RLock</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RLock 锁定 rw 进行读取。</p>
<p>​	它不应该用于递归读取锁定；一个被阻塞的 Lock 调用排除了新的读取器获取锁定。请参见 RWMutex 类型的文档。</p>
<h4 id="rwmutex-rlockerhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol224">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=224" target="_blank" rel="noopener">RLocker</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">RLocker</span>() <span style="color:#e06c75">Locker</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RLocker方法返回一个Locker接口，该接口通过调用rw.RLock和rw.RUnlock实现Lock和Unlock方法。</p>
<h4 id="rwmutex-runlockhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol111">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=111" target="_blank" rel="noopener">RUnlock</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">RUnlock</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	RUnlock方法撤消单个RLock调用；它不会影响其他同时读取者。如果rw在进入RUnlock时未被读取锁定，则会出现运行时错误。</p>
<h4 id="rwmutex-trylockhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol166----go118">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=166" target="_blank" rel="noopener">TryLock</a>  &lt;- go1.18</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">TryLock</span>() <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	TryLock方法尝试为写入锁定rw，并报告是否成功。</p>
<p>​	请注意，尽管TryLock方法的正确使用确实存在，但TryLock方法的使用往往是特定互斥锁使用中深层问题的迹象。</p>
<h4 id="rwmutex-tryrlockhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol84----go118">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=84" target="_blank" rel="noopener">TryRLock</a>  &lt;- go1.18</h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">TryRLock</span>() <span style="color:#e5c07b">bool</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	TryRLock方法尝试为读取锁定rw，并报告是否成功。</p>
<p>​	请注意，尽管TryRLock方法的正确使用确实存在，但TryRLock的使用往往是特定互斥锁使用中深层问题的迹象。</p>
<h4 id="rwmutex-unlockhttpscsopensourcegooglegogogo1201srcsyncrwmutexgol198">(*RWMutex) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/rwmutex.go;l=198" target="_blank" rel="noopener">Unlock</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">rw</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">RWMutex</span>) <span style="color:#61afef;font-weight:bold">Unlock</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Unlock方法解锁rw以进行写入。如果在进入Unlock时rw未被写入锁定，则会出现运行时错误。</p>
<p>​	与Mutexes一样，锁定的RWMutex不与特定的goroutine相关联。一个goroutine可以RLock(Lock)RWMutex，然后安排另一个goroutine RUnlock(Unlock)它。</p>
<h3 id="type-waitgrouphttpscsopensourcegooglegogogo1201srcsyncwaitgroupgol23">type <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/waitgroup.go;l=23" target="_blank" rel="noopener">WaitGroup</a></h3>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">WaitGroup</span> <span style="color:#c678dd">struct</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// contains filtered or unexported fields
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	WaitGroup结构体等待一组goroutine完成。主goroutine调用Add来设置等待的goroutine数量。然后每个goroutine都运行并在完成时调用Done。同时，可以使用Wait来阻塞，直到所有goroutine完成。</p>
<p>​	WaitGroup在第一次使用后不得复制。</p>
<p>​	在Go内存模型的术语中，Done的调用&quot;在&quot;解除任何Wait调用之前&quot;同步返回它的阻塞。</p>
<h5 id="example-2">Example</h5>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">package</span> <span style="color:#e06c75">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#98c379">&#34;sync&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">type</span> <span style="color:#e06c75">httpPkg</span> <span style="color:#c678dd">struct</span>{}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">httpPkg</span>) <span style="color:#61afef;font-weight:bold">Get</span>(<span style="color:#e06c75">url</span> <span style="color:#e5c07b">string</span>) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">var</span> <span style="color:#e06c75">http</span> <span style="color:#e06c75">httpPkg</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">func</span> <span style="color:#61afef;font-weight:bold">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">wg</span> <span style="color:#e06c75">sync</span>.<span style="color:#e06c75">WaitGroup</span>
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">var</span> <span style="color:#e06c75">urls</span> = []<span style="color:#e5c07b">string</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#98c379">&#34;http://www.golang.org/&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#98c379">&#34;http://www.google.com/&#34;</span>,
</span></span><span style="display:flex;"><span>		<span style="color:#98c379">&#34;http://www.example.com/&#34;</span>,
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#c678dd">for</span> <span style="color:#e06c75">_</span>, <span style="color:#e06c75">url</span> <span style="color:#56b6c2">:=</span> <span style="color:#c678dd">range</span> <span style="color:#e06c75">urls</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// Increment the WaitGroup counter.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#e06c75">wg</span>.<span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#d19a66">1</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#7f848e">// Launch a goroutine to fetch the URL.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>		<span style="color:#c678dd">go</span> <span style="color:#c678dd">func</span>(<span style="color:#e06c75">url</span> <span style="color:#e5c07b">string</span>) {
</span></span><span style="display:flex;"><span>			<span style="color:#7f848e">// Decrement the counter when the goroutine completes.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>			<span style="color:#c678dd">defer</span> <span style="color:#e06c75">wg</span>.<span style="color:#61afef;font-weight:bold">Done</span>()
</span></span><span style="display:flex;"><span>			<span style="color:#7f848e">// Fetch the URL.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>			<span style="color:#e06c75">http</span>.<span style="color:#61afef;font-weight:bold">Get</span>(<span style="color:#e06c75">url</span>)
</span></span><span style="display:flex;"><span>		}(<span style="color:#e06c75">url</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#7f848e">// Wait for all HTTP fetches to complete.
</span></span></span><span style="display:flex;"><span><span style="color:#7f848e"></span>	<span style="color:#e06c75">wg</span>.<span style="color:#61afef;font-weight:bold">Wait</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="waitgroup-addhttpscsopensourcegooglegogogo1201srcsyncwaitgroupgol43">(*WaitGroup) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/waitgroup.go;l=43" target="_blank" rel="noopener">Add</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">wg</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">WaitGroup</span>) <span style="color:#61afef;font-weight:bold">Add</span>(<span style="color:#e06c75">delta</span> <span style="color:#e5c07b">int</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	添加delta(可以为负数)到WaitGroup计数器中。如果计数器变为零，则所有在Wait上阻塞的goroutine都会被释放。如果计数器变为负数，则Add会panic。</p>
<p>​	请注意，在计数器为零时具有正delta的调用必须在Wait之前发生。具有负delta的调用，或者在计数器大于零时开始具有正delta的调用，可以随时发生。通常，这意味着在创建goroutine或等待其他事件的语句之前执行Add调用。如果要重用WaitGroup以等待几组独立的事件，则所有先前的Wait调用都必须返回后才能发生新的Add调用。有关WaitGroup的示例，请参见官方文档。</p>
<h4 id="waitgroup-donehttpscsopensourcegooglegogogo1201srcsyncwaitgroupgol86">(*WaitGroup) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/waitgroup.go;l=86" target="_blank" rel="noopener">Done</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">wg</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">WaitGroup</span>) <span style="color:#61afef;font-weight:bold">Done</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Done方法将WaitGroup计数器减一。</p>
<h4 id="waitgroup-waithttpscsopensourcegooglegogogo1201srcsyncwaitgroupgol91">(*WaitGroup) <a href="https://cs.opensource.google/go/go/&#43;/go1.20.1:src/sync/waitgroup.go;l=91" target="_blank" rel="noopener">Wait</a></h4>
<div class="highlight"><div style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#c678dd">func</span> (<span style="color:#e06c75">wg</span> <span style="color:#56b6c2">*</span><span style="color:#e06c75">WaitGroup</span>) <span style="color:#61afef;font-weight:bold">Wait</span>()
</span></span></code></pre></td></tr></table>
</div>
</div><p>​	Wait方法阻塞，直到WaitGroup计数器为零。</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="User mailing list" aria-label="User mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/mail" aria-label="User mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/twitter" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Stack Overflow" aria-label="Stack Overflow">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/stack" aria-label="Stack Overflow">
      <i class="fab fa-stack-overflow"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/google/docsy" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/slack" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list" aria-label="Developer mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2023 The Docsy Authors </small>
        <small class="ml-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener"></a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
  <script src="/js/main.min.9069af235eb4d4956fc4dc29e5ca46caef0cdcae593856be4e33c99075bc5ea2.js" integrity="sha256-kGmvI1601JVvxNwp5cpGyu8M3K5ZOFa&#43;TjPJkHW8XqI=" crossorigin="anonymous"></script>
<script src='/js/tabpane-persist.js'></script>
<script src='/js/deal-zero-width-space.js'></script>
  </body>
</html>
